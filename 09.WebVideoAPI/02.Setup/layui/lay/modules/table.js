layui.define(["laytpl","laypage","layer","form","util"],function(K){var y=layui.$,H=layui.laytpl,m=layui.laypage,h=layui.layer,A=layui.form,k=layui.util,r=layui.hint(),L=layui.device(),q={config:{checkName:"LAY_CHECKED",indexName:"LAY_TABLE_INDEX"},cache:{},index:layui.table?(layui.table.index+10000):0,set:function(O){var P=this;P.config=y.extend({},P.config,O);return P},on:function(O,P){return layui.onevent.call(this,M,O,P)}},o=function(){var P=this,O=P.config,Q=O.id||O.index;if(Q){o.that[Q]=P;o.config[Q]=O}return{setCheckStatus:function(S,R){P.setCheckData(S,R)},reload:function(R){P.reload.call(P,R)},setColsWidth:function(){P.setColsWidth.call(P)},resize:function(){P.resize.call(P)},config:O}},t=function(P){var O=o.config[P];if(!O){r.error("The ID option was not found in the table instance")}return O||null},M="table",j=".layui-table",u="layui-this",f="layui-show",i="layui-hide",x="layui-disabled",D="layui-none",B="layui-table-view",b=".layui-table-tool",I=".layui-table-box",v=".layui-table-init",l=".layui-table-header",g=".layui-table-body",E=".layui-table-main",F=".layui-table-fixed",e=".layui-table-fixed-l",N=".layui-table-fixed-r",c=".layui-table-total",C=".layui-table-page",w=".layui-table-sort",a="layui-table-edit",G="layui-table-hover",p=function(O){var P='{{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}}';O=O||{};return['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',function(){if(O.fixed&&O.fixed!=="right"){return'{{# if(item2.fixed && item2.fixed !== "right"){ }}'}if(O.fixed==="right"){return'{{# if(item2.fixed === "right"){ }}'}return""}(),"{{# var isSort = !(item2.colGroup) && item2.sort; }}",'<th data-field="{{ item2.field||i2 }}" data-key="{{d.index}}-{{i1}}-{{i2}}" {{# if( item2.parentKey){ }}data-parentkey="{{ item2.parentKey }}"{{# } }} {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} '+P+' {{# if(item2.unresize || item2.colGroup){ }}data-unresize="true"{{# } }} class="{{# if(item2.hide){ }}layui-hide{{# } }}{{# if(isSort){ }} layui-unselect{{# } }}{{# if(!item2.field){ }} layui-table-col-special{{# } }}">','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colGroup){ }}","group","{{# } else { }}","{{d.index}}-{{i1}}-{{i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose" {{# if(item2[d.data.checkName]){ }}checked{{# }; }}>',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(isSort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc" title="升序"></i><i class="layui-edge layui-table-sort-desc" title="降序"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",(O.fixed?"{{# }; }}":""),"{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")},J=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),s=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}}" lay-filter="LAY-table-{{d.index}}" lay-id="{{ d.data.id }}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool">','<div class="layui-table-tool-temp"></div>','<div class="layui-table-tool-self"></div>',"</div>","{{# } }}",'<div class="layui-table-box">',"{{# if(d.data.loading){ }}",'<div class="layui-table-init" style="background-color: #fff;">','<i class="layui-icon layui-icon-loading layui-icon"></i>',"</div>","{{# } }}","{{# var left, right; }}",'<div class="layui-table-header">',p(),"</div>",'<div class="layui-table-body layui-table-main">',J,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',p({fixed:true}),"</div>",'<div class="layui-table-body">',J,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',p({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',J,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.totalRow){ }}",'<div class="layui-table-total">','<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>','<tbody><tr><td><div class="layui-table-cell" style="visibility: hidden;">Total</div></td></tr></tbody>',"</table>","</div>","{{# } }}","{{# if(d.data.page){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","<style>","{{# layui.each(d.data.cols, function(i1, item1){","layui.each(item1, function(i2, item2){ }}",".laytable-cell-{{d.index}}-{{i1}}-{{i2}}{ ","{{# if(item2.width){ }}","width: {{item2.width}}px;","{{# } }}"," }","{{# });","}); }}","</style>","</div>"].join(""),n=y(window),z=y(document),d=function(O){var P=this;P.index=++q.index;P.config=y.extend({},P.config,q.config,O);P.render()};d.prototype.config={limit:10,loading:true,cellMinWidth:60,defaultToolbar:["filter","exports","print"],autoSort:true,text:{none:"无数据"}};d.prototype.render=function(){var S=this,Q=S.config;Q.elem=y(Q.elem);Q.where=Q.where||{};Q.id=Q.id||Q.elem.attr("id")||S.index;Q.request=y.extend({pageName:"page",limitName:"limit"},Q.request);Q.response=y.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",countName:"count"},Q.response);if(typeof Q.page==="object"){Q.limit=Q.page.limit||Q.limit;Q.limits=Q.page.limits||Q.limits;S.page=Q.page.curr=Q.page.curr||1;delete Q.page.elem;delete Q.page.jump}if(!Q.elem[0]){return S}if(Q.height&&/^full-\d+$/.test(Q.height)){S.fullHeightGap=Q.height.split("-")[1];Q.height=n.height()-S.fullHeightGap}S.setInit();var T=Q.elem,O=T.next("."+B),P=S.elem=y(H(s).render({VIEW_CLASS:B,data:Q,index:S.index}));Q.index=S.index;O[0]&&O.remove();T.after(P);S.layTool=P.find(b);S.layBox=P.find(I);S.layHeader=P.find(l);S.layMain=P.find(E);S.layBody=P.find(g);S.layFixed=P.find(F);S.layFixLeft=P.find(e);S.layFixRight=P.find(N);S.layTotal=P.find(c);S.layPage=P.find(C);S.renderToolbar();S.fullSize();if(Q.cols.length>1){var R=S.layFixed.find(l).find("th");R.height(S.layHeader.height()-1-parseFloat(R.css("padding-top"))-parseFloat(R.css("padding-bottom")))}S.pullData(S.page);S.events()};d.prototype.initOpts=function(R){var Q=this,P=Q.config,O={checkbox:48,radio:48,space:15,numbers:40};if(R.checkbox){R.type="checkbox"}if(R.space){R.type="space"}if(!R.type){R.type="normal"}if(R.type!=="normal"){R.unresize=true;R.width=R.width||O[R.type]}};d.prototype.setInit=function(P){var Q=this,O=Q.config;O.clientWidth=O.width||function(){var R=function(U){var T,S;U=U||O.elem.parent();T=U.width();try{S=U.css("display")==="none"}catch(V){}if(U[0]&&(!T||S)){return R(U.parent())}return T};return R()}();if(P==="width"){return O.clientWidth}layui.each(O.cols,function(S,R){layui.each(R,function(U,T){if(!T){R.splice(U,1);return}T.key=S+"-"+U;T.hide=T.hide||false;if(T.colGroup||T.colspan>1){var V=0;layui.each(O.cols[S+1],function(X,W){if(W.HAS_PARENT||(V>1&&V==T.colspan)){return}W.HAS_PARENT=true;W.parentKey=S+"-"+U;V=V+parseInt(W.colspan>1?W.colspan:1)});T.colGroup=true}Q.initOpts(T)})})};d.prototype.renderToolbar=function(){var T=this,Q=T.config;var P=['<div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>','<div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div>','<div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div>'].join(""),U=T.layTool.find(".layui-table-tool-temp");if(Q.toolbar==="default"){U.html(P)}else{if(typeof Q.toolbar==="string"){var R=y(Q.toolbar).html()||"";R&&U.html(H(R).render(Q))}}var S={filter:{title:"筛选列",layEvent:"LAYTABLE_COLS",icon:"layui-icon-cols"},exports:{title:"导出",layEvent:"LAYTABLE_EXPORT",icon:"layui-icon-export"},print:{title:"打印",layEvent:"LAYTABLE_PRINT",icon:"layui-icon-print"}},O=[];if(typeof Q.defaultToolbar==="object"){layui.each(Q.defaultToolbar,function(W,X){var V=S[X];if(V){O.push('<div class="layui-inline" title="'+V.title+'" lay-event="'+V.layEvent+'"><i class="layui-icon '+V.icon+'"></i></div>')}})}T.layTool.find(".layui-table-tool-self").html(O.join(""))};d.prototype.setParentCol=function(Q,U){var R=this,W=R.config,P=R.layHeader.find('th[data-key="'+W.index+"-"+U+'"]'),S=parseInt(P.attr("colspan"))||0;if(P[0]){var V=U.split("-"),T=W.cols[V[0]][V[1]];Q?S--:S++;P.attr("colspan",S);P[S<1?"addClass":"removeClass"](i);T.colspan=S;T.hide=S<1;var O=P.data("parentkey");O&&R.setParentCol(Q,O)}};d.prototype.setColsPatch=function(){var P=this,O=P.config;layui.each(O.cols,function(R,Q){layui.each(Q,function(T,S){if(S.hide){P.setParentCol(S.hide,S.parentKey)}})})};d.prototype.setColsWidth=function(){var U=this,Z=U.config,T=0,O=0,V=0,X=0,Y=U.setInit("width");U.eachCols(function(aa,ab){ab.hide||T++});Y=Y-function(){return(Z.skin==="line"||Z.skin==="nob")?2:T+1}()-U.getScrollWidth(U.layMain[0])-1;var R=function(aa){layui.each(Z.cols,function(ac,ab){layui.each(ab,function(ag,ad){var af=0,ae=ad.minWidth||Z.cellMinWidth;if(!ad){ab.splice(ag,1);return}if(ad.colGroup||ad.hide){return}if(!aa){af=ad.width||0;if(/\d+%$/.test(af)){af=Math.floor((parseFloat(af)/100)*Y);af<ae&&(af=ae)}else{if(!af){ad.width=af=0;O++}}}else{if(V&&V<ae){O--;af=ae}}if(ad.hide){af=0}X=X+af})});(Y>X&&O)&&(V=(Y-X)/O)};R();R(true);U.autoColNums=O;U.eachCols(function(ab,aa){var ac=aa.minWidth||Z.cellMinWidth;if(aa.colGroup||aa.hide){return}if(aa.width===0){U.getCssRule(Z.index+"-"+aa.key,function(ad){ad.style.width=Math.floor(V>=ac?V:ac)+"px"})}else{if(/\d+%$/.test(aa.width)){U.getCssRule(Z.index+"-"+aa.key,function(ad){ad.style.width=Math.floor((parseFloat(aa.width)/100)*Y)+"px"})}}});var S=U.layMain.width()-U.getScrollWidth(U.layMain[0])-U.layMain.children("table").outerWidth();if(U.autoColNums&&S>=-T&&S<=T){var P=function(aa){var ab;aa=aa||U.layHeader.eq(0).find("thead th:last-child");ab=aa.data("field");if(!ab&&aa.prev()[0]){return P(aa.prev())}return aa},Q=P(),W=Q.data("key");U.getCssRule(W,function(ab){var aa=ab.style.width||Q.outerWidth();ab.style.width=(parseFloat(aa)+S)+"px";if(U.layMain.height()-U.layMain.prop("clientHeight")>0){ab.style.width=(parseFloat(ab.style.width)-1)+"px"}})}U.loading(!0)};d.prototype.resize=function(){var O=this;O.fullSize();O.setColsWidth();O.scrollPatch()};d.prototype.reload=function(O){var P=this;if(P.config.data&&P.config.data.constructor===Array){delete P.config.data}P.config=y.extend({},P.config,O);P.render()};d.prototype.page=1;d.prototype.pullData=function(W){var T=this,X=T.config,Q=X.request,P=X.response,S=function(){if(typeof X.initSort==="object"){T.sort(X.initSort.field,X.initSort.type)}};T.startTime=new Date().getTime();if(X.url){var O={};O[Q.pageName]=W;O[Q.limitName]=X.limit;var R=y.extend(O,X.where);if(X.contentType&&X.contentType.indexOf("application/json")==0){R=JSON.stringify(R)}y.ajax({type:X.method||"get",url:X.url,contentType:X.contentType,data:R,dataType:"json",headers:X.headers||{},success:function(Y){if(typeof X.parseData==="function"){Y=X.parseData(Y)||Y}if(Y[P.statusName]!=P.statusCode){T.renderForm();T.layMain.html('<div class="'+D+'">'+(Y[P.msgName]||("返回的数据不符合规范，正确的成功状态码 ("+P.statusName+") 应为："+P.statusCode))+"</div>")}else{T.renderData(Y,W,Y[P.countName]),S();X.time=(new Date().getTime()-T.startTime)+" ms"}T.setColsWidth();typeof X.done==="function"&&X.done(Y,W,Y[P.countName])},error:function(Z,Y){T.layMain.html('<div class="'+D+'">数据接口请求异常：'+Y+"</div>");T.renderForm();T.setColsWidth()}})}else{if(X.data&&X.data.constructor===Array){var V={},U=W*X.limit-X.limit;V[P.dataName]=X.data.concat().splice(U,X.limit);V[P.countName]=X.data.length;T.renderData(V,W,X.data.length),S();T.setColsWidth();typeof X.done==="function"&&X.done(V,W,V[P.countName])}}};d.prototype.eachCols=function(P){var O=this;q.eachCols(null,P,O.config.cols);return O};d.prototype.renderData=function(V,X,S,Q){var T=this,Y=T.config,P=V[Y.response.dataName]||[],U=[],R=[],W=[],O=function(){var Z;if(!Q&&T.sortKey){return T.sort(T.sortKey.field,T.sortKey.sort,true)}layui.each(P,function(af,ac){var ae=[],aa=[],ad=[],ab=af+Y.limit*(X-1)+1;if(ac.length===0){return}if(!Q){ac[q.config.indexName]=af}T.eachCols(function(ai,ag){var ak=ag.field||ai,ah=Y.index+"-"+ag.key,aj=ac[ak];if(aj===undefined||aj===null){aj=""}if(ag.colGroup){return}var al=['<td data-field="'+ak+'" data-key="'+ah+'" '+function(){var am=[];if(ag.edit){am.push('data-edit="'+ag.edit+'"')}if(ag.align){am.push('align="'+ag.align+'"')}if(ag.templet){am.push('data-content="'+aj+'"')}if(ag.toolbar){am.push('data-off="true"')}if(ag.event){am.push('lay-event="'+ag.event+'"')}if(ag.style){am.push('style="'+ag.style+'"')}if(ag.minWidth){am.push('data-minwidth="'+ag.minWidth+'"')}return am.join(" ")}()+' class="'+function(){var am=[];if(ag.hide){am.push(i)}if(!ag.field){am.push("layui-table-col-special")}return am.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){return ag.type==="normal"?ah:(ah+" laytable-cell-"+ag.type)}()+'">'+function(){var am=y.extend(true,{LAY_INDEX:ab},ac),an=q.config.checkName;switch(ag.type){case"checkbox":return'<input type="checkbox" name="layTableCheckbox" lay-skin="primary" '+function(){if(ag[an]){ac[an]=ag[an];return ag[an]?"checked":""}return am[an]?"checked":""}()+">";break;case"radio":if(am[an]){Z=af}return'<input type="radio" name="layTableRadio_'+Y.index+'" '+(am[an]?"checked":"")+' lay-type="layTableRadio">';break;case"numbers":return ab;break}if(ag.toolbar){return H(y(ag.toolbar).html()||"").render(am)}return ag.templet?function(){return typeof ag.templet==="function"?ag.templet(am):H(y(ag.templet).html()||String(aj)).render(am)}():aj}(),"</div></td>"].join("");ae.push(al);if(ag.fixed&&ag.fixed!=="right"){aa.push(al)}if(ag.fixed==="right"){ad.push(al)}});U.push('<tr data-index="'+af+'">'+ae.join("")+"</tr>");R.push('<tr data-index="'+af+'">'+aa.join("")+"</tr>");W.push('<tr data-index="'+af+'">'+ad.join("")+"</tr>")});T.layBody.scrollTop(0);T.layMain.find("."+D).remove();T.layMain.find("tbody").html(U.join(""));T.layFixLeft.find("tbody").html(R.join(""));T.layFixRight.find("tbody").html(W.join(""));T.renderForm();typeof Z==="number"&&T.setThisRowChecked(Z);T.syncCheckAll();T.haveInit?T.scrollPatch():setTimeout(function(){T.scrollPatch()},50);T.haveInit=true;h.close(T.tipsIndex);Y.HAS_SET_COLS_PATCH||T.setColsPatch();Y.HAS_SET_COLS_PATCH=true};T.key=Y.id||Y.index;q.cache[T.key]=P;T.layPage[(S==0||(P.length===0&&X==1))?"addClass":"removeClass"](i);if(Q){return O()}if(P.length===0){T.renderForm();T.layFixed.remove();T.layMain.find("tbody").html("");T.layMain.find("."+D).remove();return T.layMain.append('<div class="'+D+'">'+Y.text.none+"</div>")}O();T.renderTotal(P);if(Y.page){Y.page=y.extend({elem:"layui-table-page"+Y.index,count:S,limit:Y.limit,limits:Y.limits||[10,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(Z,aa){if(!aa){T.page=Z.curr;Y.limit=Z.limit;T.loading();T.pullData(Z.curr)}}},Y.page);Y.page.count=S;m.render(Y.page)}};d.prototype.renderTotal=function(S){var R=this,O=R.config,Q={};if(!O.totalRow){return}layui.each(S,function(U,T){if(T.length===0){return}R.eachCols(function(W,V){var Y=V.field||W,X=T[Y];if(V.totalRow){Q[Y]=(Q[Y]||0)+(parseFloat(X)||0)}})});var P=[];R.eachCols(function(U,T){var V=T.field||U;var W=['<td data-field="'+V+'" data-key="'+O.index+"-"+T.key+'" '+function(){var X=[];if(T.align){X.push('align="'+T.align+'"')}if(T.style){X.push('style="'+T.style+'"')}if(T.minWidth){X.push('data-minwidth="'+T.minWidth+'"')}return X.join(" ")}()+' class="'+function(){var X=[];if(T.hide){X.push(i)}if(!T.field){X.push("layui-table-col-special")}return X.join(" ")}()+'">','<div class="layui-table-cell laytable-cell-'+function(){var X=(O.index+"-"+T.key);return T.type==="normal"?X:(X+" laytable-cell-"+T.type)}()+'">'+function(){var X=T.totalRowText||"";return T.totalRow?(parseFloat(Q[V]).toFixed(2)||X):X}(),"</div></td>"].join("");P.push(W)});R.layTotal.find("tbody").html("<tr>"+P.join("")+"</tr>")};d.prototype.getColElem=function(Q,P){var R=this,O=R.config;return Q.eq(0).find(".laytable-cell-"+(O.index+"-"+P)+":eq(0)")};d.prototype.renderForm=function(O){A.render(O,"LAY-table-"+this.index)};d.prototype.setThisRowChecked=function(P){var Q=this,O=Q.config,S="layui-table-click",R=Q.layBody.find('tr[data-index="'+P+'"]');R.addClass(S).siblings("tr").removeClass(S)};d.prototype.sort=function(P,X,aa,Q){var T=this,Y,W={},ab=T.config,O=ab.elem.attr("lay-filter"),R=q.cache[T.key],S;if(typeof P==="string"){T.layHeader.find("th").each(function(ad,ae){var af=y(this),ac=af.data("field");if(ac===P){P=af;Y=ac;return false}})}try{var Y=Y||P.data("field"),Z=P.data("key");if(T.sortKey&&!aa){if(Y===T.sortKey.field&&X===T.sortKey.sort){return}}var V=T.layHeader.find("th .laytable-cell-"+Z).find(w);T.layHeader.find("th").find(w).removeAttr("lay-sort");V.attr("lay-sort",X||null);T.layFixed.find("th")}catch(U){return r.error("Table modules: Did not match to field")}T.sortKey={field:Y,sort:X};if(ab.autoSort){if(X==="asc"){S=layui.sort(R,Y)}else{if(X==="desc"){S=layui.sort(R,Y,true)}else{S=layui.sort(R,q.config.indexName);delete T.sortKey}}}W[ab.response.dataName]=S||R;T.renderData(W,T.page,T.count,true);if(Q){layui.event.call(P,M,"sort("+O+")",{field:Y,type:X})}};d.prototype.loading=function(P){var Q=this,O=Q.config;if(O.loading){if(P){Q.layInit&&Q.layInit.remove();delete Q.layInit;Q.layBox.find(v).remove()}else{Q.layInit=y(['<div class="layui-table-init">','<i class="layui-icon layui-icon-loading layui-icon"></i>',"</div>"].join(""));Q.layBox.append(Q.layInit)}}};d.prototype.setCheckData=function(P,S){var R=this,O=R.config,Q=q.cache[R.key];if(!Q[P]){return}if(Q[P].constructor===Array){return}Q[P][O.checkName]=S};d.prototype.syncCheckAll=function(){var R=this,O=R.config,Q=R.layHeader.find('input[name="layTableCheckbox"]'),P=function(S){R.eachCols(function(T,U){if(U.type==="checkbox"){U[O.checkName]=S}});return S};if(!Q[0]){return}if(q.checkStatus(R.key).isAll){if(!Q[0].checked){Q.prop("checked",true);R.renderForm("checkbox")}P(true)}else{if(Q[0].checked){Q.prop("checked",false);R.renderForm("checkbox")}P(false)}};d.prototype.getCssRule=function(P,T){var R=this,Q=R.elem.find("style")[0],O=Q.sheet||Q.styleSheet||{},S=O.cssRules||O.rules;layui.each(S,function(U,V){if(V.selectorText===(".laytable-cell-"+P)){return T(V),true}})};d.prototype.fullSize=function(){var Q=this,P=Q.config,O=P.height,R;if(Q.fullHeightGap){O=n.height()-Q.fullHeightGap;if(O<135){O=135}Q.elem.css("height",O)}if(!O){return}R=parseFloat(O)-(Q.layHeader.outerHeight()||38);if(P.toolbar){R=R-(Q.layTool.outerHeight()||50)}if(P.totalRow){R=R-(Q.layTotal.outerHeight()||40)}if(P.page){R=R-(Q.layPage.outerHeight()||41)-2}Q.layMain.css("height",R)};d.prototype.getScrollWidth=function(P){var O=0;if(P){O=P.offsetWidth-P.clientWidth}else{P=document.createElement("div");P.style.width="100px";P.style.height="100px";P.style.overflowY="scroll";document.body.appendChild(P);O=P.offsetWidth-P.clientWidth;document.body.removeChild(P)}return O};d.prototype.scrollPatch=function(){var S=this,Q=S.layMain.children("table"),V=S.layMain.width()-S.layMain.prop("clientWidth"),W=S.layMain.height()-S.layMain.prop("clientHeight"),T=S.getScrollWidth(S.layMain[0]),O=Q.outerWidth()-S.layMain.width(),R=function(X){if(V&&W){X=X.eq(0);if(!X.find(".layui-table-patch")[0]){var Y=y('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>');Y.find("div").css({width:V});X.find("tr").append(Y)}}else{X.find(".layui-table-patch").remove()}};R(S.layHeader);R(S.layTotal);var U=S.layMain.height(),P=U-W;S.layFixed.find(g).css("height",Q.height()>=P?P:"auto");S.layFixRight[O>0?"removeClass":"addClass"](i);S.layFixRight.css("right",V-1)};d.prototype.events=function(){var V=this,ab=V.config,R=y("body"),S={},P=V.layHeader.find("th"),X,Z=".layui-table-cell",Q=ab.elem.attr("lay-filter");V.layTool.on("click","*[lay-event]",function(ah){var ag=y(this),ae=ag.attr("lay-event"),ac=function(ak){var al=y(ak.list),aj=y('<ul class="layui-table-tool-panel"></ul>');aj.html(al);if(ab.height){aj.css("max-height",ab.height-(V.layTool.outerHeight()||50))}ag.find(".layui-table-tool-panel")[0]||ag.append(aj);V.renderForm();aj.on("click",function(am){layui.stope(am)});ak.done&&ak.done(aj,al)};layui.stope(ah);z.trigger("table.tool.panel.remove");h.close(V.tipsIndex);switch(ae){case"LAYTABLE_COLS":ac({list:function(){var aj=[];V.eachCols(function(ak,al){if(al.field&&al.type=="normal"){aj.push('<li><input type="checkbox" name="'+al.field+'" data-key="'+al.key+'" data-parentkey="'+(al.parentKey||"")+'" lay-skin="primary" '+(al.hide?"":"checked")+' title="'+(al.title||al.field)+'" lay-filter="LAY_TABLE_TOOL_COLS"></li>')}});return aj.join("")}(),done:function(){A.on("checkbox(LAY_TABLE_TOOL_COLS)",function(an){var am=y(an.elem),al=this.checked,ak=am.data("key"),aj=am.data("parentkey");layui.each(ab.cols,function(ap,ao){layui.each(ao,function(at,aq){if(ap+"-"+at===ak){var ar=aq.hide;aq.hide=!al;V.elem.find('*[data-key="'+ab.index+"-"+ak+'"]')[al?"removeClass":"addClass"](i);if(ar!=aq.hide){V.setParentCol(!al,aj)}V.resize()}})})})}});break;case"LAYTABLE_EXPORT":if(L.ie){h.tips("导出功能不支持 IE，请用 Chrome 等高级浏览器导出",this,{tips:3})}else{ac({list:function(){return['<li data-type="csv">导出到 Csv 文件</li>','<li data-type="xls">导出到 Excel 文件</li>'].join("")}(),done:function(aj,ak){ak.on("click",function(){var al=y(this).data("type");q.exportFile(ab.id,null,al)})}})}break;case"LAYTABLE_PRINT":var ai=window.open("打印窗口","_blank"),af=["<style>","body{font-size: 12px; color: #666;}","table{width: 100%; border-collapse: collapse; border-spacing: 0;}","th,td{line-height: 20px; padding: 9px 15px; border: 1px solid #ccc; text-align: left; font-size: 12px; color: #666;}","a{color: #666; text-decoration:none;}","*.layui-hide{display: none}","</style>"].join(""),ad=y(V.layHeader.html());ad.append(V.layMain.find("table").html());ad.find("th.layui-table-patch").remove();ad.find(".layui-table-col-special").remove();ai.document.write(af+ad.prop("outerHTML"));ai.document.close();ai.print();ai.close();break}layui.event.call(this,M,"toolbar("+Q+")",y.extend({event:ae,config:ab},{}))});P.on("mousemove",function(af){var ae=y(this),ac=ae.offset().left,ad=af.clientX-ac;if(ae.data("unresize")||S.resizeStart){return}S.allowResize=ae.width()-ad<=10;R.css("cursor",(S.allowResize?"col-resize":""))}).on("mouseleave",function(){var ac=y(this);if(S.resizeStart){return}R.css("cursor","")}).on("mousedown",function(ae){var ad=y(this);if(S.allowResize){var ac=ad.data("key");ae.preventDefault();S.resizeStart=true;S.offset=[ae.clientX,ae.clientY];V.getCssRule(ac,function(ag){var af=ag.style.width||ad.outerWidth();S.rule=ag;S.ruleWidth=parseFloat(af);S.minWidth=ad.data("minwidth")||ab.cellMinWidth})}});z.on("mousemove",function(ad){if(S.resizeStart){ad.preventDefault();if(S.rule){var ac=S.ruleWidth+ad.clientX-S.offset[0];if(ac<S.minWidth){ac=S.minWidth}S.rule.style.width=ac+"px";h.close(V.tipsIndex)}X=1}}).on("mouseup",function(ac){if(S.resizeStart){S={};R.css("cursor","");V.scrollPatch()}if(X===2){X=null}});P.on("click",function(ag){var ae=y(this),af=ae.find(w),ac=af.attr("lay-sort"),ad;if(!af[0]||X===1){return X=2}if(ac==="asc"){ad="desc"}else{if(ac==="desc"){ad=null}else{ad="asc"}}V.sort(ae,ad,null,true)}).find(w+" .layui-edge ").on("click",function(af){var ad=y(this),ac=ad.index(),ae=ad.parents("th").eq(0).data("field");layui.stope(af);if(ac===0){V.sort(ae,"asc",null,true)}else{V.sort(ae,"desc",null,true)}});var Y=function(ad){var ag=y(this),ac=ag.parents("tr").eq(0).data("index"),af=V.layBody.find('tr[data-index="'+ac+'"]'),ae=q.cache[V.key][ac];return y.extend({tr:af,data:q.clearCacheKey(ae),del:function(){q.cache[V.key][ac]=[];af.remove();V.scrollPatch()},update:function(ah){ah=ah||{};layui.each(ah,function(aj,ak){if(aj in ae){var ai,al=af.children('td[data-field="'+aj+'"]');ae[aj]=ak;V.eachCols(function(an,am){if(am.field==aj&&am.templet){ai=am.templet}});al.children(Z).html(function(){return ai?function(){return typeof ai==="function"?ai(ae):H(y(ai).html()||ak).render(ae)}():ak}());al.data("content",ak)}})}},ad)};V.elem.on("click",'input[name="layTableCheckbox"]+',function(){var ag=y(this).prev(),af=V.layBody.find('input[name="layTableCheckbox"]'),ad=ag.parents("tr").eq(0).data("index"),ae=ag[0].checked,ac=ag.attr("lay-filter")==="layTableAllChoose";if(ac){af.each(function(ah,ai){ai.checked=ae;V.setCheckData(ah,ae)});V.syncCheckAll();V.renderForm("checkbox")}else{V.setCheckData(ad,ae);V.syncCheckAll()}layui.event.call(ag[0],M,"checkbox("+Q+")",Y.call(ag[0],{checked:ae,type:ac?"all":"one"}))});V.elem.on("click",'input[lay-type="layTableRadio"]+',function(){var ad=y(this).prev(),af=ad[0].checked,ae=q.cache[V.key],ac=ad.parents("tr").eq(0).data("index");layui.each(ae,function(ag,ah){if(ac===ag){ah.LAY_CHECKED=true}else{delete ah.LAY_CHECKED}});V.setThisRowChecked(ac);layui.event.call(this,M,"radio("+Q+")",Y.call(this,{checked:af}))});V.layBody.on("mouseenter","tr",function(){var ad=y(this),ac=ad.index();V.layBody.find("tr:eq("+ac+")").addClass(G)}).on("mouseleave","tr",function(){var ad=y(this),ac=ad.index();V.layBody.find("tr:eq("+ac+")").removeClass(G)}).on("click","tr",function(){U.call(this,"row")}).on("dblclick","tr",function(){U.call(this,"rowDouble")});var U=function(ac){var ad=y(this);layui.event.call(this,M,ac+"("+Q+")",Y.call(ad.children("td")[0]))};V.layBody.on("change","."+a,function(){var af=y(this),ae=this.value,ag=af.parent().data("field"),ac=af.parents("tr").eq(0).data("index"),ad=q.cache[V.key][ac];ad[ag]=ae;layui.event.call(this,M,"edit("+Q+")",Y.call(this,{value:ae,field:ag}))}).on("blur","."+a,function(){var ac,af=y(this),ag=af.parent().data("field"),ad=af.parents("tr").eq(0).data("index"),ae=q.cache[V.key][ad];V.eachCols(function(ah,ai){if(ai.field==ag&&ai.templet){ac=ai.templet}});af.siblings(Z).html(function(ah){return ac?function(){return typeof ac==="function"?ac(ae):H(y(ac).html()||this.value).render(ae)}():ah}(this.value));af.parent().data("content",this.value);af.remove()});V.layBody.on("click","td",function(ah){var af=y(this),ag=af.data("field"),ad=af.data("edit"),ae=af.children(Z);if(af.data("off")){return}if(ad){var ac=y('<input class="layui-input '+a+'">');ac[0].value=af.data("content")||ae.text();af.find("."+a)[0]||af.append(ac);ac.focus();layui.stope(ah);return}}).on("mouseenter","td",function(){O.call(this)}).on("mouseleave","td",function(){O.call(this,"hide")});var aa="layui-table-grid",T="layui-table-grid-down",W="layui-table-grid-panel",O=function(ad){var ae=y(this),ac=ae.children(Z);if(ad){ae.find(".layui-table-grid-down").remove()}else{if(ac.prop("scrollWidth")>ac.outerWidth()){if(ac.find("."+T)[0]){return}ae.append('<div class="'+T+'"><i class="layui-icon layui-icon-down"></i></div>')}}};V.layBody.on("click","."+T,function(ae){var ad=y(this),af=ad.parent(),ac=af.children(Z);V.tipsIndex=h.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(ac.height()+16)+"px;"+function(){if(ab.size==="sm"){return"padding: 4px 15px; font-size: 12px;"}if(ab.size==="lg"){return"padding: 14px 15px;"}return""}()+'">',ac.html(),"</div>",'<i class="layui-icon layui-table-tips-c layui-icon-close"></i>'].join(""),ac[0],{tips:[3,""],time:-1,anim:-1,maxWidth:(L.ios||L.android)?300:V.elem.width()/2,isOutAnim:false,skin:"layui-table-tips",success:function(ag,ah){ag.find(".layui-table-tips-c").on("click",function(){h.close(ah)})}});layui.stope(ae)});V.layBody.on("click","*[lay-event]",function(){var ad=y(this),ac=ad.parents("tr").eq(0).data("index");layui.event.call(this,M,"tool("+Q+")",Y.call(this,{event:ad.attr("lay-event")}));V.setThisRowChecked(ac)});V.layMain.on("scroll",function(){var ac=y(this),ae=ac.scrollLeft(),ad=ac.scrollTop();V.layHeader.scrollLeft(ae);V.layTotal.scrollLeft(ae);V.layFixed.find(g).scrollTop(ad);h.close(V.tipsIndex)});z.on("click",function(){z.trigger("table.remove.tool.panel")});z.on("table.remove.tool.panel",function(){y(".layui-table-tool-panel").remove()});n.on("resize",function(){V.resize()})};q.init=function(R,Q){Q=Q||{};var S=this,P=R?y('table[lay-filter="'+R+'"]'):y(j+"[lay-data]"),O="Table element property lay-data configuration item has a syntax error: ";P.each(function(){var V=y(this),U=V.attr("lay-data");try{U=new Function("return "+U)()}catch(X){r.error(O+U)}var W=[],T=y.extend({elem:this,cols:[],data:[],skin:V.attr("lay-skin"),size:V.attr("lay-size"),even:typeof V.attr("lay-even")==="string"},q.config,Q,U);R&&V.hide();V.find("thead>tr").each(function(Y){T.cols[Y]=[];y(this).children().each(function(aa){var ab=y(this),Z=ab.attr("lay-data");try{Z=new Function("return "+Z)()}catch(ac){return r.error(O+Z)}var ad=y.extend({title:ab.text(),colspan:ab.attr("colspan")||0,rowspan:ab.attr("rowspan")||0},Z);if(ad.colspan<2){W.push(ad)}T.cols[Y].push(ad)})});V.find("tbody>tr").each(function(Y){var Z=y(this),aa={};Z.children("td").each(function(ac,ab){var ae=y(this),ad=ae.data("field");if(ad){return aa[ad]=ae.html()}});layui.each(W,function(ac,ab){var ad=Z.children("td").eq(ac);aa[ab.field]=ad.html()});T.data[Y]=aa});q.render(T)});return S};o.that={};o.config={};q.eachCols=function(U,T,S){var Q=o.config[U]||{},P=[],O=0;S=y.extend(true,[],S||Q.cols);layui.each(S,function(W,V){layui.each(V,function(Y,X){if(X.colGroup){var Z=0;O++;X.CHILD_COLS=[];layui.each(S[W+1],function(ab,aa){if(aa.PARENT_COL_INDEX||(Z>1&&Z==X.colspan)){return}aa.PARENT_COL_INDEX=O;X.CHILD_COLS.push(aa);Z=Z+parseInt(aa.colspan>1?aa.colspan:1)})}if(X.PARENT_COL_INDEX){return}P.push(X)})});var R=function(V){layui.each(V||P,function(W,X){if(X.CHILD_COLS){return R(X.CHILD_COLS)}typeof T==="function"&&T(W,X)})};R()};q.setCheckStatus=function(P,O){o.setCheckData(P,O)};q.checkStatus=function(S){var R=0,P=0,O=[],Q=q.cache[S]||[];layui.each(Q,function(T,U){if(U.constructor===Array){P++;return}if(U[q.config.checkName]){R++;O.push(q.clearCacheKey(U))}});return{data:O,isAll:Q.length?(R===(Q.length-P)):false}};q.exportFile=function(T,R,Q){R=R||q.clearCacheKey(q.cache[T]);Q=Q||"csv";var O=o.config[T]||{},S=({csv:"text/csv",xls:"application/vnd.ms-excel"})[Q],P=document.createElement("a");if(L.ie){return r.error("IE_NOT_SUPPORT_EXPORTS")}P.href="data:"+S+";charset=utf-8,\ufeff"+encodeURIComponent(function(){var V=[],U=[];layui.each(R,function(X,W){var Y=[];if(typeof T==="object"){layui.each(T,function(Z,aa){X==0&&V.push(aa||"")});layui.each(q.clearCacheKey(W),function(aa,Z){Y.push(Z)})}else{q.eachCols(T,function(aa,Z){if(Z.field&&Z.type=="normal"&&!Z.hide){X==0&&V.push(Z.title||"");Y.push(W[Z.field])}})}U.push(Y.join(","))});return V.join(",")+"\r\n"+U.join("\r\n")}());P.download=(O.title||"table_"+(O.index||""))+"."+Q;document.body.appendChild(P);P.click();document.body.removeChild(P)};q.resize=function(P){if(P){var O=t(P);if(!O){return}o.that[P].resize()}else{layui.each(o.that,function(){this.resize()})}};q.reload=function(Q,P){P=P||{};var O=t(Q);if(!O){return}if(P.data&&P.data.constructor===Array){delete O.data}return q.render(y.extend(true,{},O,P))};q.render=function(O){var P=new d(O);return o.call(P)};q.clearCacheKey=function(O){O=y.extend({},O);delete O[q.config.checkName];delete O[q.config.indexName];return O};q.init();K(M,q)});