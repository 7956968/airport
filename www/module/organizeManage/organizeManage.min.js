(function(){var e=utility.getLocalStorage("language"),t=utility.getLocalStorage("userInfo"),a=utility.getLocalStorage("bizParam"),i=utility.getLocalStorage("provinceList"),n=new Vue({el:"#js-vue",data:{language:e?e.language:"CN",isTableLoading:!0,isShowModal:!1,isShowDetail:!1,isModalLoading:!0,modalTitle:"",tableHeight:function(){var e=$(".tableContainer").height();return e-100}(),pageInfo:{id:0,count:0,pageNum:1,pageSize:20,companyName:"",paraCompanyId:""},index:0,selectItem:null,itemInfo:{id:"",companyName:"",companyTypeId:"",companyEnName:"",companyShortName:"",paraCompanyId:"",openTime:"",chargeManId:"",chargeManName:"",contactPhone:"",contactEmail:"",contactFax:"",countryId:0,provinceId:"",cityId:"",districtId:"",address:"",postCode:"",website:"",business:"",remark:"",createUserId:t.id,modifyUserId:t.id},columnsList:[{type:"index",width:60,align:"center"},{title:{CN:"公司名称",EN:"Company name",TW:"公司名稱"}[e.language],key:"companyName"},{title:{CN:"外文名称",EN:"companyEnName Name",TW:"外文名稱"}[e.language],key:"companyEnName"},{title:{CN:"公司性质",EN:"Company Nature",TW:"公司性質"}[e.language],key:"companyTypeId"},{title:{CN:"成立时间",EN:"Founding Time",TW:"成立時間"}[e.language],key:"openTime"},{title:{CN:"负责人",EN:"Head",TW:"負責人"}[e.language],key:"chargeManName"},{title:{CN:"经营范围",EN:"Management Scope",TW:"經營範圍"}[e.language],key:"business"},{title:{CN:"备注",EN:"Remarks",TW:"備註"}[e.language],key:"remark"},{title:{CN:"操作",EN:"Operation",TW:"操作"}[e.language],key:"operation",width:180,render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){n.index=a.index,n.selectItem=a.row,n.showDetail()}}},{CN:"详情",EN:"Detail",TW:"詳情"}[e.language]),t("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){n.index=a.index,n.selectItem=a.row,n.editItem()}}},{CN:"编辑",EN:"Edite",TW:"編輯"}[e.language]),t("Button",{props:{type:"error",size:"small"},on:{click:function(){n.index=a.index,n.selectItem=a.row,n.delItem()}}},{CN:"删除",EN:"Delete",TW:"刪除"}[e.language])])}}],tableRowList:[],companyList:[],companyTypeList:a.companyType,provinceList:i,cityList:[],districtList:[]},methods:{refresh:function(){var e=this;window.location.href=window.location.href,0==e.isTableLoading&&(e.isTableLoading=!0,setTimeout(function(){e.isTableLoading=!1},3e3))},addItem:function(){var e=this;e.isShowModal=!0,e.isModalLoading=!0,e.modalTitle={CN:"新增",EN:"Add",TW:"新增"}[e.language],e.itemInfo={id:"",companyName:"",companyTypeId:"",companyEnName:"",companyShortName:"",paraCompanyId:"",openTime:"",chargeManId:"",chargeManName:"",contactPhone:"",contactEmail:"",contactFax:"",countryId:0,provinceId:"",cityId:"",districtId:"",address:"",postCode:"",website:"",business:"",remark:"",createUserId:t.id,modifyUserId:t.id}},editItem:function(){var e=this;utility.showMessageTip(e,function(){e.itemInfo=e.companyList[e.index],e.itemInfo.companyName=decodeURI(e.itemInfo.companyName),e.itemInfo.companyShortName=decodeURI(e.itemInfo.companyShortName),e.itemInfo.chargeManName=decodeURI(e.itemInfo.chargeManName),e.itemInfo.address=decodeURI(e.itemInfo.address),e.itemInfo.business=decodeURI(e.itemInfo.business),e.itemInfo.remark=decodeURI(e.itemInfo.remark),e.isShowModal=!0,e.modalTitle={CN:"修改",EN:"Edit",TW:"修改"}[e.language],delete e.itemInfo.createTime,delete e.itemInfo.modifyTime,delete e.itemInfo.createUserName,e.getCityList(),e.getDistrictList()})},showDetail:function(){var e=this;utility.showMessageTip(e,function(){e.itemInfo=e.companyList[e.index],e.itemInfo.companyName=decodeURI(e.itemInfo.companyName),e.itemInfo.companyShortName=decodeURI(e.itemInfo.companyShortName),e.itemInfo.chargeManName=decodeURI(e.itemInfo.chargeManName),e.itemInfo.address=decodeURI(e.itemInfo.address),e.itemInfo.business=decodeURI(e.itemInfo.business),e.itemInfo.remark=decodeURI(e.itemInfo.remark),e.isShowDetail=!0})},delItem:function(){var e=this;e.$Modal.confirm({title:"确定删除？",width:200,onOk:function(){e.itemInfo=e.companyList[e.index],utility.showMessageTip(e,function(){utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.delCompany+"&id="+e.itemInfo.id+"&modifyUserId="+t.id,actionUrl:CONFIG.SERVICE.companyService,beforeSendCallback:function(){e.isTableLoading=!0},completeCallback:function(){e.isTableLoading=!1},successCallback:function(t){200==t.code?e.getCompanyList(!0):e.$Message.error(t.message)}})})}})},setCurrentRowData:function(e,t){var a=this;e&&(a.index=t,a.selectItem=e)},pageSizeChange:function(e){var t=this;t.pageInfo.pageNum=parseInt(e,10),setTimeout(function(){t.getCompanyList(!1)},200)},pageRowChange:function(e){var t=this;t.pageInfo.pageSize=parseInt(e,10),setTimeout(function(){t.getCompanyList(!1)},200)},validateInput:function(){},uploadDataToServer:function(){var e=this,a=utility.getDateDetailInfo(e.itemInfo.openTime);utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.saveCompany,actionUrl:CONFIG.SERVICE.companyService,dataObj:{id:e.itemInfo.id||0,companyName:encodeURI(e.itemInfo.companyName),companyTypeId:e.itemInfo.companyTypeId,companyEnName:e.itemInfo.companyEnName,companyShortName:encodeURI(e.itemInfo.companyShortName),paraCompanyId:e.itemInfo.paraCompanyId,openTime:a.year+"-"+a.month+"-"+a.date,chargeManName:encodeURI(e.itemInfo.chargeManName),contactPhone:e.itemInfo.contactPhone,contactEmail:e.itemInfo.contactEmail,contactFax:e.itemInfo.contactFax,countryId:0,provinceId:e.itemInfo.provinceId,cityId:e.itemInfo.cityId,districtId:e.itemInfo.districtId,address:encodeURI(e.itemInfo.address),postCode:e.itemInfo.postCode,website:e.itemInfo.website,business:encodeURI(e.itemInfo.business),remark:encodeURI(e.itemInfo.remark),createUserId:t.id,modifyUserId:t.id},completeCallback:function(){e.isModalLoading=!1},successCallback:function(t){200==t.code?(e.getCompanyList(!0),e.isShowModal=!1):e.$Message.error(t.message)}})},formatTableList:function(){for(var e=this,t=0,a=e.companyList.length;t<a;t++)e.tableRowList.push({companyName:decodeURI(e.companyList[t].companyName),companyEnName:e.companyList[t].companyEnName,openTime:e.companyList[t].openTime,chargeManName:decodeURI(e.companyList[t].chargeManName),business:decodeURI(e.companyList[t].business),remark:decodeURI(e.companyList[t].remark),companyTypeId:function(){for(var a="",i=0,n=e.companyTypeList.length;i<n;i++)if(e.companyTypeList[i].type==e.companyList[t].companyTypeId){a=e.companyTypeList[i].name;break}return a}()})},getCompanyList:function(e){var t=this;t.tableRowList=[],1==e&&(t.pageInfo.pageNum=0),utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.getCompanyList,actionUrl:CONFIG.SERVICE.companyService,dataObj:t.pageInfo,beforeSendCallback:function(){t.isTableLoading=!0},completeCallback:function(){t.isTableLoading=!1},successCallback:function(e){200==e.code&&(t.companyList=e.data,t.pageInfo.count=e.count,t.formatTableList())}})},getCityList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.commonService+"?action="+CONFIG.ACTION.getCityList+"&provinceId="+e.itemInfo.provinceId,actionUrl:CONFIG.SERVICE.commonService,successCallback:function(t){200==t.code&&(e.cityList=t.data,e.districtList=[])}})},getDistrictList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.commonService+"?action="+CONFIG.ACTION.getDistrictList+"&cityId="+e.itemInfo.cityId,actionUrl:CONFIG.SERVICE.commonService,successCallback:function(t){200==t.code&&(e.districtList=t.data)}})}},created:function(){var e=this;utility.isLogin(!1),setTimeout(function(){e.getCompanyList(!1)},500)}})})();