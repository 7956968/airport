(function(){var e,i=utility.getLocalStorage("language"),t=(utility.getLocalStorage("userInfo"),utility.getLocalStorage("bizParam"));new Vue({el:"#js-vue",data:{language:i?i.language:"CN",isTableLoading:!0,isShowModal:!1,isModalLoading:!0,tableHeight:(e=$(".tableContainer").height(),e-100),vehicleColorList:t.vehicleColor,vehicleTypeList:t.vehicleType,vehicleBrandList:t.vehicleBrand,pageInfo:{id:"",deptId:"",companyId:"",vehicleCode:"",vehicleColorId:"",vehicleTypeId:"",vehicleBrandId:"",vehicleTypeId:"",beginMiles:"",endMiles:"",beginTime:"",endTime:""},page:{count:0,pageSize:20,pageNum:1},columnsList:[{type:"index",width:60,title:"序号",align:"center"},{title:{CN:"公司",EN:"Company",TW:"公司"}[i.language],key:"companyName"},{title:{CN:"部门",EN:"Department",TW:"部門"}[i.language],key:"deptName"},{title:{CN:"车辆名称",EN:"Vehicle Name",TW:"車輛名稱"}[i.language],key:"vehicleName"},{title:{CN:"车辆编码",EN:"Vehicle Name",TW:"車輛編碼"}[i.language],key:"vehicleCode"},{title:{CN:"里程数",EN:"Mileage(km)",TW:"里程數(公里)"}[i.language],key:"miles",sortable:!0,render:function(e,i){return e("div",[e("span",{},i.row.miles+"公里")])}},{title:{CN:"里程占比",EN:"Mileage(percent)",TW:"里程數占比"}[i.language],key:"mileRate",sortable:!0}],departmentList:[],vehicleList:[],companyList:[],userList:[]},methods:{refresh:function(){var e=this;window.location.href=window.location.href,0==e.isTableLoading&&(e.isTableLoading=!0,setTimeout(function(){e.isTableLoading=!1},3e3))},beginRepairTime:function(e,i){var t=this;t.pageInfo.beginTime=e},endRepairTime:function(e,i){var t=this;t.pageInfo.endTime=e},pageSizeChange:function(e){var i=this;i.page.pageNum=parseInt(e,10),setTimeout(function(){i.getVehicleMileRateReport(!1)},200)},pageRowChange:function(e){var i=this;i.page.pageSize=parseInt(e,10),setTimeout(function(){i.getVehicleMileRateReport(!0)},200)},getVehicleMileRateReport:function(e){var i=this;i.vehicleList=[],1==e&&(i.page.pageNum=0,i.page.count=0),utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.vehicleService+"?action="+CONFIG.ACTION.getVehicleMileRateReport,actionUrl:CONFIG.SERVICE.vehicleService,dataObj:{pageNum:i.page.pageNum,pageSize:i.page.pageSize,deptId:i.pageInfo.deptId,companyId:i.pageInfo.companyId,vehicleCode:encodeURI(i.pageInfo.vehicleCode),vehicleColorId:i.pageInfo.vehicleColorId,vehicleTypeId:i.pageInfo.vehicleTypeId,vehicleBrandId:i.pageInfo.vehicleBrandId,vehicleTypeId:i.pageInfo.vehicleTypeId,beginMiles:i.pageInfo.beginMiles,endMiles:i.pageInfo.endMiles,beginTime:i.pageInfo.beginTime,endTime:i.pageInfo.endTime},beforeSendCallback:function(){i.isTableLoading=!0},completeCallback:function(){i.isTableLoading=!1},successCallback:function(e){200==e.code&&(i.vehicleList=e.data,i.page.count=e.count)}})},changeToGetDetp:function(){var e=this;e.getDepartmentList()},getDepartmentList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.deptService+"?action="+CONFIG.ACTION.getDeptList,actionUrl:CONFIG.SERVICE.deptService,dataObj:{id:0,companyId:e.pageInfo.companyId,pageSize:1e4},successCallback:function(i){200==i.code&&(e.departmentList=i.data)}})},getCompanyList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.getCompanyList,actionUrl:CONFIG.SERVICE.companyService,dataObj:{id:0,pageSize:1e4},successCallback:function(i){200==i.code&&(e.companyList=i.data)}})}},created:function(){var e=this;utility.isLogin(!1),setTimeout(function(){e.getVehicleMileRateReport(!0),e.getDepartmentList(),e.getCompanyList(),e.$watch("pageInfo",function(){e.getVehicleMileRateReport(!0)},{deep:!0})},500)}})})();