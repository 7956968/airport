(function(){var e=utility.getLocalStorage("language"),t=utility.getLocalStorage("userInfo"),i=utility.getLocalStorage("bizParam");new Vue({el:"#js-vue",data:{language:e?e.language:"CN",isTableLoading:!0,isShowModal:!1,isShowReset:!1,isModalLoading:!0,modalTitle:"",tableHeight:function(){var e=$(".tableContainer").height();return e-100}(),index:0,selectItem:null,itemInfo:{id:"",userCode:"",userPwd:"",companyId:"",userSeq:"",userName:"",sex:"",birthday:"",mobile:"",telephone:"",email:"",remark:"",status:"",idNo:"",address:"",createUserId:t.id,modifyUserId:t.id},pageInfo:{id:0,count:0,pageNum:1,pageSize:15,userCode:"",userName:"",companyId:""},columnsList:[{type:"index",width:60,align:"center"},{title:{CN:"账号",EN:"Account",TW:"帳號"}[e.language],key:"userCode"},{title:{CN:"姓名",EN:"Name",TW:"姓名"}[e.language],key:"userName"},{title:{CN:"性别",EN:"Gender",TW:"性別"}[e.language],key:"sex"},{title:{CN:"手机号",EN:"cellPhone No.",TW:"手機號"}[e.language],key:"mobile"},{title:{CN:"固话",EN:"Fixed Telephone",TW:"固話"}[e.language],key:"telephone"},{title:{CN:"所属公司",EN:"Company",TW:"所屬公司"}[e.language],key:"company"},{title:{CN:"员工工号",EN:"Staff Number",TW:"員工工號"}[e.language],key:"userSeq"},{title:{CN:"状态",EN:"State",TW:"狀態"}[e.language],key:"state"},{title:{CN:"备注",EN:"Remarks",TW:"備註"}[e.language],key:"remark"}],tableRowList:[],superiorCompanyList:[],userList:[],companyList:[],sexTypeList:i.sexType,userStatusTypeList:i.userStatusType},methods:{refresh:function(){var e=this;window.location.href=window.location.href,0==e.isTableLoading&&(e.isTableLoading=!0,setTimeout(function(){e.isTableLoading=!1},3e3))},addItem:function(){var e=this;e.isShowModal=!0,e.isModalLoading=!0,e.modalTitle={CN:"新增",EN:"Add",TW:"新增"}[e.language],e.itemInfo={id:"",userCode:"",userPwd:"",companyId:"",userSeq:"",userName:"",sex:"",birthday:"",mobile:"",telephone:"",email:"",remark:"",status:"",idNo:"",address:"",createUserId:t.id,modifyUserId:t.id}},editItem:function(){var e=this;utility.showMessageTip(e,function(){e.itemInfo=e.userList[e.index],e.itemInfo.userName=decodeURI(e.itemInfo.userName),e.itemInfo.remark=decodeURI(e.itemInfo.remark),e.itemInfo.address=decodeURI(e.itemInfo.address),e.isShowModal=!0,e.modalTitle={CN:"修改",EN:"Edit",TW:"修改"}[e.language]})},delItem:function(){var e=this;e.itemInfo=e.userList[e.index],utility.showMessageTip(e,function(){utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.userService+"?action="+CONFIG.ACTION.delUser+"&ids="+e.itemInfo.id+"&modifyUserId="+t.id,actionUrl:CONFIG.SERVICE.userService,beforeSendCallback:function(){e.isTableLoading=!0},completeCallback:function(){e.isTableLoading=!1},successCallback:function(t){200==t.code?e.getUserList(!0):e.$Message.error(t.message)}})})},pageSizeChange:function(e){var t=this;t.pageInfo.pageNum=parseInt(e,10)-1,setTimeout(function(){t.getUserList(!1)},200)},pageRowChange:function(e){var t=this;t.pageInfo.pageSize=parseInt(e,10),setTimeout(function(){t.getUserList(!1)},200)},setCurrentRowData:function(e,t){var i=this;e&&(i.index=t,i.selectItem=e)},uploadDataToServer:function(){var e=this,i=utility.getDateDetailInfo(e.itemInfo.birthday);utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.userService+"?action="+CONFIG.ACTION.saveUser,actionUrl:CONFIG.SERVICE.userService,dataObj:{id:e.itemInfo.id,userCode:e.itemInfo.userCode,userPwd:e.itemInfo.userPwd,companyId:e.itemInfo.companyId,userSeq:e.itemInfo.userSeq,userName:encodeURI(e.itemInfo.userName),sex:e.itemInfo.sex,birthday:i.year+"-"+i.month+"-"+i.date,mobile:e.itemInfo.mobile,telephone:e.itemInfo.telephone,email:e.itemInfo.email,remark:encodeURI(e.itemInfo.remark),status:e.itemInfo.status,idNo:e.itemInfo.idNo,address:encodeURI(e.itemInfo.address),createUserId:t.id,modifyUserId:t.id},completeCallback:function(){e.isModalLoading=!1},successCallback:function(t){200==t.code?(e.getUserList(!0),e.isShowModal=!1):e.$Message.error(t.message)}})},formatTableList:function(){for(var e=this,t=0,i=e.userList.length;t<i;t++)e.tableRowList.push({userCode:e.userList[t].userCode,userName:decodeURI(e.userList[t].userName),userSeq:e.userList[t].userSeq,mobile:e.userList[t].mobile,telephone:e.userList[t].telephone,company:decodeURI(e.userList[t].companyName),remark:decodeURI(e.userList[t].remark),sex:function(){for(var i="",a=0,s=e.sexTypeList.length;a<s;a++)if(e.sexTypeList[a].type==e.userList[t].sex){i=e.sexTypeList[a].name;break}return i}(),state:function(){for(var i="",a=0,s=e.userStatusTypeList.length;a<s;a++)if(e.userStatusTypeList[a].type==e.userList[t].status){i=e.userStatusTypeList[a].name;break}return i}()})},getUserList:function(e){var t=this;1==e&&(t.tableRowList=[],t.pageInfo.pageNum=0),utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.userService+"?action="+CONFIG.ACTION.getUserList,actionUrl:CONFIG.SERVICE.userService,dataObj:t.pageInfo,beforeSendCallback:function(){t.isTableLoading=!0},completeCallback:function(){t.isTableLoading=!1},successCallback:function(e){200==e.code&&(t.userList=e.data,t.pageInfo.count=e.count,t.formatTableList())}})},getCompanyList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.getCompanyList,actionUrl:CONFIG.SERVICE.companyService,dataObj:{id:0,pageSize:1e4},successCallback:function(t){200==t.code&&(e.companyList=t.data)}})}},created:function(){var e=this;utility.isLogin(!1),setTimeout(function(){e.getUserList(!1),e.getCompanyList()},500)}})})();