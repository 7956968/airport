(function(){var e,a=utility.getLocalStorage("language"),t=(utility.getLocalStorage("userInfo"),utility.getLocalStorage("bizParam")),i=new Vue({el:"#js-vue",data:{language:a?a.language:"CN",isTableLoading:!0,isShowModal:!1,isShowTerminal:!1,isModalLoading:!0,modalTitle:"",tableHeight:(e=$(".tableContainer").height(),e-100),vehiclePassType:t.vehiclePassType,pageInfo:{areaId:"",areaName:"",areaCode:"",vehicleId:"",companyId:"",vehicleName:"",vehicleCode:"",crossTypeId:""},page:{count:0,pageSize:20,pageNum:0},columnsList:[{type:"index",width:60,title:"序号",align:"center"},{title:{CN:"防区名称",EN:"Defense Name",TW:"防區名稱"}[a.language],key:"areaName"},{title:{CN:"车辆名称",EN:"Vehicle Name",TW:"車輛名稱"}[a.language],key:"vehicleName"},{title:{CN:"车辆编码",EN:"Vehicle Type",TW:"車輛編碼"}[a.language],key:"vehicleCode"},{title:{CN:"防区类型",EN:"Defense Type",TW:"防區類型"}[a.language],key:"crossTypeName",align:"center"},{title:{CN:"行驶速度",EN:"Speed",TW:"行駛速度"}[a.language],key:"speed",sortable:!0,render:function(e,a){return e("div",[e("span",{},a.row.speed+"（公里/小时）")])}},{title:{CN:"时间",EN:"Time",TW:"時間"}[a.language],key:"crossTime",width:160},{title:"坐标",key:"currPosition",width:160,render:function(e,a){var t=JSON.parse(i.dataList[a.index].currPosition).coordinates.join(",");return e("div",t)}},{title:"地址",key:"lastAddress",width:300}],dataList:[],companyList:[]},methods:{refresh:function(){var e=this;window.location.href=window.location.href,0==e.isTableLoading&&(e.isTableLoading=!0,setTimeout(function(){e.isTableLoading=!1},3e3))},pageSizeChange:function(e){var a=this;a.page.pageNum=parseInt(e,10),setTimeout(function(){a.getCrossAreaList(!1)},200)},pageRowChange:function(e){var a=this;a.page.pageSize=parseInt(e,10),setTimeout(function(){a.getCrossAreaList(!0)},200)},getCrossAreaList:function(e){var a=this;a.dataList=[],1==e&&(a.page.pageNum=0,a.page.count=0),utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.vehicleService+"?action="+CONFIG.ACTION.getCrossAreaList,actionUrl:CONFIG.SERVICE.vehicleService,dataObj:{areaId:a.pageInfo.areaId,pageNum:a.page.pageNum,pageSize:a.page.pageSize,areaCode:a.pageInfo.areaCode,vehicleId:a.pageInfo.vehicleId,companyId:a.pageInfo.companyId,vehicleCode:a.pageInfo.vehicleCode,crossTypeId:a.pageInfo.crossTypeId,areaName:encodeURI(a.pageInfo.areaName),vehicleName:encodeURI(a.pageInfo.vehicleName)},beforeSendCallback:function(){a.isTableLoading=!0},completeCallback:function(){a.isTableLoading=!1},successCallback:function(e){if(200==e.code){var t=[];a.page.count=e.count;for(var i=0,n=e.data.length;i<n;i++)t.push(e.data[i]),t[i].lastAddress="";a.dataList=t;for(var o=0;o<e.data.length;o++)(function(t){if(e.data[t].currPosition){var i=JSON.parse(e.data[t].currPosition).coordinates;0!=i[0]&&0!=i[1]?utility.convertorByBaidu(i,gcoord,BMap,function(e,i,n){utility.getAdressDetail([i,n],BMap,function(e){a.dataList[t].lastAddress=e})}):a.dataList[t].lastAddress="--"}else a.dataList[t].lastAddress="--"})(o)}}})},getCompanyList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.getCompanyList,actionUrl:CONFIG.SERVICE.companyService,dataObj:{id:0,pageSize:1e4},successCallback:function(a){200==a.code&&(e.companyList=a.data)}})}},created:function(){var e=this;utility.isLogin(!1),setTimeout(function(){e.getCompanyList(),e.getCrossAreaList(!0),e.$watch("pageInfo",function(){e.getCrossAreaList(!0)},{deep:!0})},500)}})})();