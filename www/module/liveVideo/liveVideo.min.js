new Vue({el:"#js-vue",data:{isShowDetail:!0,vehicleInfo:JSON.parse(decodeURI(utility.getQueryParams().vehicleInfo)),queryInfo:utility.getQueryParams(),mIP:"220.231.225.7",mPort:7668,mUserName:"mgkj",mPwd:"888888",mVideoCount:8,maxVideoNum:10,codeType:!0,front:null,cNet:"",FPS:"",pageCurrent:1,pageNum:0,frontChildren:[],seleceChannel:[{value:"0-0"},{value:"1-1"},{value:"2-2"},{value:"3-3"},{value:"4-4"},{value:"5-5"},{value:"6-6"},{value:"7-7"}],flagChannel:[{value:"0-0"},{value:"1-1"},{value:"2-2"},{value:"3-3"},{value:"4-4"},{value:"5-5"},{value:"6-6"},{value:"7-7"}],isStop:!1,offLine:!1,timeOfflineOut:null,timeOffline:5,timeLen:120,timeSelect:"120",timeLenOut:null,netnSignal:"",msgType:"primary",msgInfo:"",isFullScream:!1,channelIndex:"-",fullScreamIndex:"",defaultColor:"rgb(255,125,0)",splitNum:4,connectTimeOut:null,dragAndDrop:{sourceEle:null,targetEle:null,sourceStyle:"",targetStyle:""},splitArea:[1,4,6,8,9],videoWinSplit:{_1:{count:1,normal:[{top:"0px",left:"0px",width:"calc(100% - 4px)",height:"calc(100% - 4px)"}],page:[{top:"0px",left:"0px",width:"calc(100% - 4px)",height:"calc(100% - 4px)"}]},_4:{count:4,normal:[{top:"0px",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"}],page:[{top:"0px",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"}]},_6:{count:6,normal:[{top:"0px",left:"0px",width:"calc(100% / 3 * 2 - 6px)",height:"calc(100% / 3 * 2 - 8px)"},{top:"calc(100% / 3 * 2 - 4px)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1)"},{top:"calc(100% / 3 * 2 - 4px)",left:"calc(100% / 3 * 1 - 0px)",width:"calc(100% / 3 * 1 - 6px)",height:"calc(100% / 3 * 1)"},{top:"calc(100% / 3 * 2 - 4px)",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1)"},{top:"0px",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 2px)",height:"calc(100% / 3 * 1 - 8px)"},{top:"calc(100% / 3 * 1 - 4px)",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"}],page:[{top:"0px",left:"0px",width:"calc(100% / 3 * 2 - 6px)",height:"calc(100% / 3 * 2 - 8px)"},{top:"calc(100% / 3 * 2 - 4px)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1)"},{top:"calc(100% / 3 * 2 - 4px)",left:"calc(100% / 3 * 1 - 0px)",width:"calc(100% / 3 * 1 - 6px)",height:"calc(100% / 3 * 1)"},{top:"calc(100% / 3 * 2 - 4px)",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1)"},{top:"0px",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 2px)",height:"calc(100% / 3 * 1 - 8px)"},{top:"calc(100% / 3 * 1 - 4px)",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"}]},_8:{count:8,page:[{top:"0px",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"}],normal:[{top:"0px",left:"0px",width:"calc(100% / 4 * 3 - 6px)",height:"calc(100% / 4 * 3 - 8px)"},{top:"0px",left:"calc(100% / 4 * 3 - 2px)",width:"calc(100% / 4 * 1 - 4px)",height:"calc(100% / 4 * 1 - 6px)"},{top:"calc(100% / 4 * 1 - 2px)",left:"calc(100% / 4 * 3 - 2px)",width:"calc(100% / 4 * 1 - 4px)",height:"calc(100% / 4 * 1 - 6px)"},{top:"calc(100% / 4 * 2 - 4px)",left:"calc(100% / 4 * 3 - 2px)",width:"calc(100% / 4 * 1 - 4px)",height:"calc(100% / 4 * 1 - 4px)"},{top:"calc(100% / 4 * 3 - 4px)",left:"0px",width:"calc(100% / 4 * 1 - 4px)",height:"calc(100% / 4 * 1)"},{top:"calc(100% / 4 * 3 - 4px)",left:"calc(100% / 4 * 1 - 0px)",width:"calc(100% / 4 * 1 - 6px)",height:"calc(100% / 4 * 1)"},{top:"calc(100% / 4 * 3 - 4px)",left:"calc(100% / 4 * 2 - 2px)",width:"calc(100% / 4 * 1 - 4px)",height:"calc(100% / 4 * 1)"},{top:"calc(100% / 4 * 3 - 4px)",left:"calc(100% / 4 * 3 - 2px)",width:"calc(100% / 4 * 1 - 2px)",height:"calc(100% / 4 * 1)"}]},_9:{count:9,normal:[{top:"0px",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"0px",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"0px",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 2)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"},{top:"calc(100% / 3 * 2)",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"},{top:"calc(100% / 3 * 2)",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"}],page:[{top:"0px",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"0px",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"0px",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 2)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"},{top:"calc(100% / 3 * 2)",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"},{top:"calc(100% / 3 * 2)",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"}]}},isNormal:!1,videoWinSplitDemo:[{count:1,param:[{top:"0px",left:"0px",width:"calc(100% - 4px)",height:"calc(100% - 4px)"}]},{count:4,param:[{top:"0px",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"}]},{count:6,param:[{top:"0px",left:"0px",width:"calc(100% / 3 * 2 - 6px)",height:"calc(100% / 3 * 2 - 8px)"},{top:"calc(100% / 3 * 2 - 4px)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1)"},{top:"calc(100% / 3 * 2 - 4px)",left:"calc(100% / 3 * 1 - 0px)",width:"calc(100% / 3 * 1 - 6px)",height:"calc(100% / 3 * 1)"},{top:"calc(100% / 3 * 2 - 4px)",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1)"},{top:"0px",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 2px)",height:"calc(100% / 3 * 1 - 8px)"},{top:"calc(100% / 3 * 1 - 4px)",left:"calc(100% / 3 * 2 - 2px)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"}]},{count:8,param:[{top:"0px",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"0px",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"0px",width:"calc(50% - 4px)",height:"calc(50% - 4px)"},{top:"50%",left:"50%",width:"calc(50% - 4px)",height:"calc(50% - 4px)"}]},{count:9,param:[{top:"0px",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"0px",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"0px",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 6px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 1 - 2px)",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 2px)"},{top:"calc(100% / 3 * 2)",left:"0px",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"},{top:"calc(100% / 3 * 2)",left:"calc(100% / 3 * 1)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"},{top:"calc(100% / 3 * 2)",left:"calc(100% / 3 * 2)",width:"calc(100% / 3 * 1 - 4px)",height:"calc(100% / 3 * 1 - 4px)"}]}]},methods:{init:function(){var e=this;if(e.mVideoCount>e.maxVideoNum||e.mVideoCount<0)return e.$Message.destroy(),e.msgType="error",void(e.msgInfo="视频窗口数量有误");e.updateVideoWin(8),e.connectNet()},onTimeChange:function(e){var t=this;t.timeLen=parseInt(e,10)},onChannelChange:function(e){for(var t=this,c=e.split("-"),l=$(".hiddenVideo"),i=!0,a=$("body").find("#hidden"+c[1]),n=0,o=l.length;n<o;n++)if(2==t.pageCurrent){if(n>3&&$(l[n]).val()!=a.val()&&c[0]==$(l[n]).val().split("-")[0]){i=!1,t.seleceChannel[c[1]].value=a.val(),alert("摄像机"+t.frontChildren[c[0]].name+"正在其他通道播放，请选择其他摄像头");break}}else if(n<4&&$(l[n]).val()!=a.val()&&c[0]==$(l[n]).val().split("-")[0]){i=!1,t.seleceChannel[c[1]].value=a.val(),alert("摄像机"+t.frontChildren[c[0]].name+"正在其他通道播放，请选择其他摄像头");break}1==i&&(a.val(e),vsclientSession.startPlay({name:t.vehicleInfo.licenseNumber,channel:c[0],videoCtrl:$("#video"+c[1])[0],codeType:t.codeType}))},playSigleVideo:function(e,t){var c=this,l=t.split("-");$("body").find("#video"+l[1]).attr("src").length<10?vsclientSession.startPlay({name:c.vehicleInfo.licenseNumber,channel:e,videoCtrl:$("#video"+l[1])[0],codeType:c.codeType}):vsclientSession.stopPlay($("body").find("#video"+l[1])[0])},playAllVedio:function(){var e=this,t=$("body").find(".left"),c=$("body").find(".right");e.isNormal=!e.isNormal,e.updateVideoWin(8),1==e.isNormal?(t.css({zIndex:1e3,opacity:1}),c.css({zIndex:1e3,opacity:1}),t.each(function(t){var c=$(this).attr("data-id"),l=$(this).attr("data-index");$("#"+c).attr("src").length<20&&($("#"+c).attr("controls",!0),vsclientSession.startPlay({name:e.vehicleInfo.licenseNumber,channel:l,videoCtrl:$("#"+c)[0],codeType:e.codeType}))}),c.each(function(t){var c=$(this).attr("data-id"),l=$(this).attr("data-index");$("#"+c).attr("src").length<20&&($("#"+c).attr("controls",!0),vsclientSession.startPlay({name:e.vehicleInfo.licenseNumber,channel:l,videoCtrl:$("#"+c)[0],codeType:e.codeType}))})):(t.css({zIndex:1e3,opacity:1}),c.css({zIndex:10,opacity:0}),t.each(function(t){var c=$(this).attr("data-id"),l=$(this).attr("data-index");$("#"+c).attr("src").length<20&&($("#"+c).attr("controls",!0),vsclientSession.startPlay({name:e.vehicleInfo.licenseNumber,channel:l,videoCtrl:$("#"+c)[0],codeType:e.codeType}))}),c.each(function(e){var t=$(this).attr("data-id");$(this).attr("data-index"),vsclientSession.stopPlay($("body").find("#"+t)[0])})),clearInterval(e.timeLenOut),e.timeLenOut=null,setTimeout(function(){e.timeLenOut=setInterval(function(){e.timeLen--,e.$Message.destroy(),(e.timeLen<=0||1==e.isStop)&&(e.stopVideo(""),clearInterval(e.timeLenOut))},1e3),e.stopAudio(),$("body").find("video").removeAttr("controls")},5e3)},pageSizeChange:function(e){var t=this,c=$("body").find(".left"),l=$("body").find(".right");return t.pageCurrent=e,1==e?(c.css({zIndex:1e3,opacity:1}),l.css({zIndex:10,opacity:0}),c.each(function(e){var c=$(this).attr("data-id"),l=$(this).attr("data-index");vsclientSession.startPlay({name:t.vehicleInfo.licenseNumber,channel:l,videoCtrl:$("#"+c)[0],codeType:t.codeType})}),void l.each(function(e){var t=$(this).attr("data-id");$(this).attr("data-index"),vsclientSession.stopPlay($("body").find("#"+t)[0])})):2==e?(l.css({zIndex:1e3,opacity:1}),c.css({zIndex:10,opacity:0}),l.each(function(e){var c=$(this).attr("data-id"),l=$(this).attr("data-index");vsclientSession.startPlay({name:t.vehicleInfo.licenseNumber,channel:l,videoCtrl:$("#"+c)[0],codeType:t.codeType})}),void c.each(function(e){var t=$(this).attr("data-id");$(this).attr("data-index"),vsclientSession.stopPlay($("body").find("#"+t)[0])})):void 0},setCurrentStyle:function(e){$("body").find(".videoItem").removeClass("active"),$("body").find("#"+e).addClass("active")},connectNet:function(){var e=this,t={onLoginFailed:function(){e.$Message.destroy(),e.msgType="error",e.msgInfo="车辆 【"+e.vehicleInfo.licenseNumber+"】登录失败",clearInterval(e.timeLenOut),setTimeout(function(){vsclientSession.login(e.mUserName,e.mPwd,e.mIP,e.mPort)},3e3)},onlogon:function(t){var c=vsclientSession.findFrontByName(e.vehicleInfo.licenseNumber);if(e.front=c,e.frontChildren=e.front.children,e.$Message.destroy(),e.msgType="success",e.msgInfo="车辆 【"+e.vehicleInfo.licenseNumber+"】登录成功",null==c)return e.msgType="error",e.msgInfo="车辆【 "+e.vehicleInfo.licenseNumber+" 】不存在",e.isStop=!0,void clearInterval(e.timeLenOut);e.pageNum=e.frontChildren.length>8?8:e.frontChildren.length,e.startVideo(),e.listenVideoFrame()},onOnOffline:function(t){t.name==e.vehicleInfo.licenseNumber&&(0==t.online?(e.$Message.destroy(),e.msgType="error",e.msgInfo="车辆【 "+e.vehicleInfo.licenseNumber+" 】已经下线",e.isStop=!0,e.timeOfflineOut=null,clearInterval(e.timeLenOut),e.timeOfflineOut=setInterval(function(){e.timeOffline--,e.timeOffline<=0&&e.stopVideo(e.msgInfo)},1e3)):e.startVideo())},onServerConnectionLost:function(){e.$Message.destroy(),e.msgType="error",e.msgInfo="车辆【 "+e.vehicleInfo.licenseNumber+" 】连接失败",e.stopVideo(e.msgInfo)},onStreamPlayStatus:function(t){switch(t){case STREAM_PLAY_STATE_REQUESTTING:e.msgInfo="",e.$Message.destroy(),e.$Message.loading({content:"正在请求视频......"}),clearInterval(e.timeLenOut);break;case STREAM_PLAY_STATE_REQ_STREAM_SUCCESS:e.msgInfo="",e.$Message.destroy();break;case STREAM_PLAY_STATE_PLAY_STRAM_SUCCESS:e.$Message.destroy(),e.msgType="success",e.msgInfo="",e.isStop=!1;break;case STREAM_PLAY_STATE_PLAY_STRAM_FAILED:e.$Message.destroy(),e.msgType="error",e.msgInfo="视频播放失败",clearInterval(e.timeLenOut);break;default:e.$Message.destroy(),e.msgType="error",e.msgInfo="播放状态异常",clearInterval(e.timeLenOut)}},onGpsData:function(t){e.netnSignal=t.gps.net_signal}};window.vsclientSession=new VSClientSession(t),vsclientSession.login(e.mUserName,e.mPwd,e.mIP,e.mPort),e.msgInfo="",e.$Message.destroy(),e.$Message.loading({content:"车辆【 "+e.vehicleInfo.licenseNumber+" 】登录中......"}),clearInterval(e.timeLenOut)},getVideoFrame:function(e){var t=this,c=VideoFrame({id:e,frameRate:29.97,callback:function(e){if(navigator.connection.downlink){var c=1024*navigator.connection.downlink/8;t.cNet=c/1024>=1?"当前网速:"+c/1024+"MB/s":"当前网速:"+c+"KB/s"}}});c.listen("frame")},listenVideoFrame:function(){var e=this,t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},c=0,l=Date.now(),i=Date.now(),a=function(){var n=Date.now(),o=n-i,p=Math.round(1e3/o);i=n,c++,n>1e3+l&&(p=Math.round(1e3*c/(n-l)),c=0,l=n,e.FPS=p),t(a)};a()},updateVideoWin:function(e){var t=this,c=null;if(c=1==t.isNormal?t.videoWinSplit["_"+e].normal:t.videoWinSplit["_"+e].page,null==c)return t.$Message.destroy(),t.msgType="error",t.msgInfo="分屏数据定义有误",void clearInterval(t.timeLenOut);$("body").find(".videoItem").css("display","none");for(var l=0;l<e;l++){var i=$("body").find("#liveVideo"+l);if(null==i)return t.$Message.destroy(),t.msgType="error",t.msgInfo="当前视频窗口定义不存在",void clearInterval(t.timeLenOut);i.css({top:c[l].top,left:c[l].left,width:c[l].width,height:c[l].height,display:"block"}),t.getVideoFrame("#video"+l)}t.splitNum=e,$("body").find("#liveVideo0").addClass("active")},getSplitNumFromChNum:function(e){return e<4?1:e<5?4:e<7?6:e<9?8:9},playVideo:function(e){var t=this;if(!e.online)return t.$Message.destroy(),t.msgType="error",t.isStop=!0,t.msgInfo="车辆【 "+t.vehicleInfo.licenseNumber+" 】已经下线",void clearInterval(t.timeLenOut);var c=4,l=!1;1==t.isNormal&&(c=8),t.$Message.destroy(),t.msgType="blue";for(var i=0;i<c;i++)$("#video"+i).attr("controls",!0),l=vsclientSession.startPlay({name:t.vehicleInfo.licenseNumber,channel:i,videoCtrl:$("#video"+i)[0],codeType:t.codeType});setTimeout(function(){for(var e=0;e<c;e++)$("#video"+e).removeAttr("controls")},2e4),l?(t.isStop=!1,t.msgInfo="",t.$Message.destroy(),t.$Message.loading({content:"正在请求视频......"}),clearInterval(t.timeLenOut),t.timeLenOut=null,setTimeout(function(){t.timeLenOut=setInterval(function(){t.timeLen--,t.$Message.destroy(),(t.timeLen<=0||1==t.isStop)&&(t.stopVideo(""),clearInterval(t.timeLenOut))},1e3),t.stopAudio(),setTimeout(function(){$("body").find("#playAudio_0").on("click"),$("body").find("#playAudio_0").trigger("click")},3e3)},1e4)):(t.$Message.destroy(),t.msgType="error",t.msgInfo="请求视频失败",clearInterval(t.timeLenOut))},reStart:function(){var e=this;vsclientSession.login(e.mUserName,e.mPwd,e.mIP,e.mPort),e.msgInfo="",e.$Message.destroy(),e.$Message.loading({content:"车辆【 "+e.vehicleInfo.licenseNumber+" 】登录中......"}),clearInterval(e.timeLenOut)},startVideo:function(){var e=this,t=vsclientSession.findFrontByName(e.vehicleInfo.licenseNumber);if(null==t)return e.$Message.destroy(),e.msgType="error",e.msgInfo="车辆【 "+e.vehicleInfo.licenseNumber+" 】不存在",e.isStop=!0,void clearInterval(e.timeLenOut);e.timeLen=120,e.timeSelect="120",e.stopAudio(),e.playVideo(t)},stopVideo:function(e){for(var t=this,c=0;c<t.mVideoCount;c++)vsclientSession.stopPlay($("body").find("#video"+c)[0]);t.isStop=!0,t.$Message.destroy(),t.msgType="error",t.msgInfo="string"==typeof e?e:"",clearInterval(t.timeLenOut),clearInterval(t.timeOfflineOut),t.timeOffline=5,t.timeLen<=0&&(t.timeLen=parseInt(t.timeSelect)),t.stopAudio()},setFullScream:function(e){var t=$("body").find("#"+e)[0],c=t.requestFullScreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullScreen;if(void 0!==c&&c)c.call(t);else if(void 0!==window.ActiveXObject){var l=new ActiveXObject("WScript.Shell");null!=l&&l.SendKeys("{F11}")}},playAudio:function(e){var t=this;t.channelIndex=e,vsclientSession.stopListening(),setTimeout(function(){vsclientSession.startListening(t.vehicleInfo.licenseNumber,t.channelIndex)},1e3)},stopAudio:function(){var e=this;e.channelIndex="-",vsclientSession.stopListening()},dragEnd:function(e){var t=this,c=$(e.srcElement);t.dragAndDrop.sourceEle=c,t.dragAndDrop.sourceStyle=c.attr("style")},drop:function(e){var t=this,c=$(e.srcElement).parents(".videoItem");e.preventDefault(),t.dragAndDrop.targetEle=c,t.dragAndDrop.targetStyle=c.attr("style"),setTimeout(function(){t.dragAndDrop.targetEle.attr("style",t.dragAndDrop.sourceStyle),t.dragAndDrop.sourceEle.attr("style",t.dragAndDrop.targetStyle)},250)},dragOver:function(e){e.preventDefault()},backPage:function(){window.close()}},mounted:function(){var e=this;e.$Message.config({top:5,duration:0,closable:!0}),e.$Notice.config({top:5,duration:0,closable:!0}),e.init()}});