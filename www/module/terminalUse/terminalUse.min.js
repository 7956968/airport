(function(){var e,t=utility.getLocalStorage("language"),i=utility.getLocalStorage("userInfo"),a=utility.getLocalStorage("bizParam");new Vue({el:"#js-vue",data:{language:t?t.language:"CN",isTableLoading:!0,isShowModal:!1,isShowTerminal:!1,isModalLoading:!0,modalTitle:"",tableHeight:(e=$(".tableContainer").height(),e-100),terminalStatusList:a.terminalStatus,deviceProviderList:a.deviceProviderId,pageInfo:{count:0,pageSize:20,pageNum:1,id:"",companyId:"",deptId:"",providerId:"",deviceStatus:"",deviceCode:"",dataPeriod:"",versionName:"",versionNum:"",bindFlag:0,createUserId:i.id,modifyUserId:i.id},columnsList:[{type:"index",align:"center",title:"序号",width:60},{title:"公司",key:"companyId",width:200},{title:"运行状态",key:"deviceStatus",align:"center"},{title:"终端编号",key:"deviceCode"},{title:"供应商",key:"providerId"},{title:"上报周期",key:"dataPeriod",align:"center",render:function(e,t){return e("div",[e("span",{},t.row.dataPeriod+"秒")])}},{title:"当前速度",key:"speed",sortable:!0,align:"center",render:function(e,t){return e("div",[e("span",{},t.row.speed+"（公里/小时）")])}},{title:"电量",key:"power",sortable:!0,align:"center",render:function(e,t){var i={_18600000026:"93",_18600000016:"98",_18600000019:"98",_18600000021:"98",_18600000027:"94",_18600000031:"95",_18600000014:"97",_18600000032:"94",_18600000010:"98",_18600000008:"99",_18600000001:"84",_18600000017:"100",_18600000030:"100",_18600000007:"100",_18600000033:"100"};return e("div",[e("span",{},(i["_"+t.row.deviceCode]||t.row.power)+"%")])}}],dataList:[],terminalList:[],companyList:[],departmentList:[]},methods:{refresh:function(){var e=this;window.location.href=window.location.href,0==e.isTableLoading&&(e.isTableLoading=!0,setTimeout(function(){e.isTableLoading=!1},3e3))},pageSizeChange:function(e){var t=this;t.pageInfo.pageNum=parseInt(e,10),setTimeout(function(){t.getTerminalList(!1)},200)},pageRowChange:function(e){var t=this;t.pageInfo.pageSize=parseInt(e,10),setTimeout(function(){t.getTerminalList(!1)},200)},formatTerminal:function(){for(var e=this,t=0,i=e.terminalList.length;t<i;t++)e.dataList.push({providerId:e.terminalList[t].providerName,deviceCode:decodeURI(e.terminalList[t].deviceCode),dataPeriod:e.terminalList[t].dataPeriod,versionName:decodeURI(e.terminalList[t].versionName),versionNum:e.terminalList[t].versionNum,speed:e.terminalList[t].speed,power:e.terminalList[t].power,lastPosition:e.terminalList[t].lastPosition,lastDataTime:e.terminalList[t].lastDataTime,companyId:e.terminalList[t].companyName,companyName:decodeURI(e.terminalList[t].companyName),deviceStatus:decodeURI(e.terminalList[t].deviceStatusName)})},getTerminalList:function(e){var t=this;t.dataList=[],1==e&&(t.pageInfo.pageNum=1),utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.deviceService+"?action="+CONFIG.ACTION.getDeviceList,actionUrl:CONFIG.SERVICE.deviceService,dataObj:t.pageInfo,beforeSendCallback:function(){t.isTableLoading=!0},completeCallback:function(){t.isTableLoading=!1},successCallback:function(e){200==e.code&&(t.terminalList=e.data,t.pageInfo.count=e.count,t.formatTerminal())}})},getCompanyList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.getCompanyList,actionUrl:CONFIG.SERVICE.companyService,dataObj:{id:0,pageSize:1e4},successCallback:function(t){200==t.code&&(e.companyList=t.data)}})}},created:function(){var e=this;utility.isLogin(!1),setTimeout(function(){e.getTerminalList(!0),e.getCompanyList(),e.$watch("pageInfo",function(){e.getTerminalList(!0)},{deep:!0})},500)}})})();