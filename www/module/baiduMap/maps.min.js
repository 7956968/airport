(function(){var e=utility.getLocalStorage("language"),a=utility.getLocalStorage("airPort"),n=utility.getLocalStorage("userInfo"),t=utility.getLocalStorage("bizParam"),o=utility.getLocalStorage("userFuncList"),i=function(){var e={isViewVideo:!1,isSearch:!1,isTrack:!1};for(var a in o)if(o.hasOwnProperty(a))for(var n=0,t=o[a].length;n<t;n++)"device_manage_view_video"==o[a][n].functionCode&&(e.isViewVideo=!0),"map_query_live_vehicle"==o[a][n].functionCode&&(e.isSearch=!0),"map_view_track"==o[a][n].functionCode&&(e.isTrack=!0),"device_manage_secure_area"==o[a][n].functionCode&&(e.isDefense=!0),"device_manage_camera"==o[a][n].functionCode&&(e.isCamera=!0);return e}();Vue.use(VueBaiduMap.default,{ak:"eCaU3zoABU2Ggtuc8vAoTrkc"}),window.pageVue=new Vue({el:"#js-vue",components:{"bml-marker-clusterer":VueBaiduMap.BmlMarkerClusterer},data:{functionInfo:i,isShenZhen:!1,deleteLoading:!1,addLoading:!1,language:e?e.language:"CN",airPort:a?[parseFloat(a.airPort.split(",")[0],10),parseFloat(a.airPort.split(",")[1],10)]:[113.8077,22.6286],companyList:[],departmentList:[],userFuncList:o,searchId:"",searchCode:"",openInfoWidth:0,openInfoHeight:0,baiduMapInfo:{BMap:null,map:null,mapType:"BMAP_NORMAL_MAP",center:{lng:0,lat:0},zoom:18,overviewMapControl:null,speed:90,vehicleMarkers:{},markerClusterer:null,openInfoWindow:{type:"",show:!1,show:!1,position:{lng:0,lat:0}},animationInfo:{timeInterval:null,coordinates:[],trajectoryInfo:[],curveInfo:[],pointInfo:[],moveVehicle:null,speed:90,trajectoryItem:{time:"",speed:"",coordinate:[],position:{lng:0,lat:0},vehicleCode:"",companyName:"",deptName:"",vehicleName:"",licenseNumber:"",lastGpsTime:"",vehicleTypeName:"",address:""}},camera:{},cameraClusterer:null,cameraMarkers:[],defensList:{},defensPath:[],isCloseDefensPath:!1,defensPathEdit:!0,layersInfo:{isSeat:!0,isAlarm:!0,isVehicle:!0,isDefense:!0,isCamera:!0}},modal:{isLayer:!1,isAlarm:!1,isCamera:!1,isSearch:!1,isVehicle:!1,isHistory:!1,isDefense:!1},layerControl:["seat","alarm","vehicle","defens","camera"],vehiclePageInfo:{id:"",count:0,pageNum:1,deptId:"",pageSize:15,vehicleName:"",vehicleCode:"",gpsDeviceCode:""},vehiclePositonPageInfo:{span:10,count:0,pageNum:1,deptId:"",pageSize:15,companyId:"",id:"",vehicleName:"",vehicleCode:"",licenseNumber:"",gpsDeviceCode:"",vehicleTypeId:"",vehicleStatus:"",useStatus:-1,vehicleColorId:"",vehicleBrandId:"",centerPosition:""},vehicleItem:{id:"",speed:"",power:"",deptId:"",deptName:"",modifyTime:"",gpsDeviceId:"",companyName:"",vehicleName:"",vehicleCode:"",lastPosition:"",vehicleTypeId:"",gpsDeviceCode:"",vehicleStatus:"",vehicleColorId:"",vehicleBrandId:"",vehicleStatusName:""},vehicleItemPop:null,vehicleList:[],isAddVehiclePosition:!1,isDbClickSearch:!1,terminalStatusList:t.terminalStatus,vehicleColorList:t.vehicleColor,vehicleTypeList:t.vehicleType,vehicleBrandList:t.vehicleBrand,secureAreaLimitTypeList:t.secureAreaLimitType,vehicleColumns:[{title:{CN:"\u540D\u79F0",EN:"Name",TW:"\u540D\u7A31"}[e.language],key:"vehicleName"},{title:{CN:"\u7C7B\u578B",EN:"Type",TW:"\u985E\u578B"}[e.language],key:"vehicleTypeId"},{title:{CN:"\u7F16\u7801",EN:"Code",TW:"\u7DE8\u78BC"}[e.language],key:"vehicleCode"},{title:{CN:"\u72B6\u6001",EN:"State",TW:"\u72C0\u614B"}[e.language],key:"vehicleStatus"}],vehicleDatas:[],vehiclePositionItem:{o:"",id:"",speed:"",power:"",deptId:"",deptName:"",modifyTime:"",gpsDeviceId:"",companyName:"",vehicleName:"",vehicleCode:"",lastPosition:"",vehicleTypeId:"",gpsDeviceCode:"",vehicleStatus:"",vehicleColorId:"",vehicleBrandId:"",vehicleStatusName:""},vehiclePositionList:[],singleVehiclePageInfo:{date:new Date,endTime:"",id:"",beginTime:"",lastGpsTime:"",vehicleCode:"",licenseNumber:"",gpsDeviceCode:""},vehicleAddressDetail:"",trackItem:{coordinate:[],licenseNumber:""},isTrackItem:!1,dateTimeInfo:{date:new Date,beginDate:function(){var e=utility.getDateDetailInfo();return e.year+"-"+e.month+"-"+e.date}(),endDate:function(){var e=utility.getDateDetailInfo();return e.year+"-"+e.month+"-"+e.date}(),beginTime:"00:00:00",endTime:"23:59:59"},singleVehicleItem:{},historyColumns:[],historyDatas:[],isAddDefensAction:!1,isAddDefensDetailInfo:!1,isDrawDefening:!1,isDeleteDefens:!1,secureAreaStatusList:t.secureAreaStatus,defensPageInfo:{count:0,pageNum:1,pageSize:15,areaName:"",companyId:"",secureStatus:""},defensAreaDetailInfo:{id:"",opType:1,companyId:"",deptId:"",deptIds:[],areaName:"",areaCode:"",secureStatus:"",areaRangeStr:"",speedLimit:"",staySecond:"",canEnter:"",canExit:"",canStay:"",remark:"",createUserId:n.id,modifyUserId:n.id},defensColumns:[{title:{CN:"\u540D\u79F0",EN:"Name",TW:"\u540D\u7A31"}[e.language],key:"areaName",fixed:"left",width:120},{title:{CN:"\u7F16\u7801",EN:"Code",TW:"\u7DE8\u78BC"}[e.language],key:"areaCode",width:120},{title:{CN:"\u72B6\u6001",EN:"Status",TW:"\u72C0\u614B"}[e.language],key:"secureStatus",width:120},{title:{CN:"\u901F\u5EA6\u4E0A\u9650",EN:"Speed Limit",TW:"\u901F\u5EA6\u4E0A\u9650"}[e.language],key:"speedLimit",width:120},{title:{CN:"\u505C\u7559\u65F6\u957F",EN:"Length Of Stay",TW:"\u505C\u7559\u6642\u9577"}[e.language],key:"staySecond",width:120},{title:{CN:"\u64CD\u4F5C",EN:"Operation",TW:"\u64CD\u4F5C"}[e.language],key:"operation",fixed:"right",width:80,render:function(a){var i=JSON.stringify(o.menu_map),n="";return n=-1==i.indexOf("device_manage_secure_area")?{CN:"\u67E5\u770B",EN:"View",TW:"\u67E5\u770B"}[e.language]:{CN:"\u5220\u9664",EN:"Delete",TW:"\u5220\u9664"}[e.language],a("div",[a("Button",{props:{type:"error",size:"small"},on:{click:function(){console.log("111"),setTimeout(function(){pageVue.deleteDefensArea()},500)}}},n)])}}],defensDatas:[],defensList:[],defensColor:{_701:{fill:"rgb(4, 159, 228)",stroke:"rgb(33, 121, 160)"},_702:{fill:"rgb(255, 0, 0)",stroke:"rgba(5, 174, 253)"},_703:{fill:"rgb(255, 173, 51)",stroke:"rgba(99, 71, 31)"},_704:{fill:"rgb(180, 191, 195)",stroke:"rgba(122, 150, 162)"}},isAddCameraAction:!1,isAddcameraDetailInfo:!1,isDeleteCamera:!1,monitorStatusList:t.monitorStatusId,cameraPageInfo:{count:0,pageNum:1,pageSize:15,monitorStatus:""},cameraDetailInfo:{id:"",companyId:"",companyName:"",deptId:"",deptIds:[],deptName:"",cameraName:"",cameraCode:"",cameraDesc:"",cameraPositionStr:"",radius:"",angle:"",monitorStatus:"",remark:"",rtspLiveUrl:"",rtspHisUrl:"",createUserId:n.id,modifyUserId:n.id},cameraColumns:[{title:{CN:"\u540D\u79F0",EN:"Name",TW:"\u540D\u7A31"}[e.language],key:"cameraName",fixed:"left",width:100},{title:{CN:"\u72B6\u6001",EN:"State",TW:"\u72C0\u614B"}[e.language],key:"monitorStatus",width:100},{title:{CN:"\u516C\u53F8",EN:"Company",TW:"\u516C\u53F8"}[e.language],key:"companyName",width:150},{title:{CN:"\u7F16\u7801",EN:"Code",TW:"\u7DE8\u78BC"}[e.language],key:"cameraCode",width:150},{title:{CN:"\u63CF\u8FF0",EN:"Describe",TW:"\u63CF\u8FF0"}[e.language],key:"cameraDesc",width:150},{title:{CN:"Rtsp\u76F4\u64AD\u5730\u5740",EN:"Live URL",TW:"Rtsp\u76F4\u64AD\u5730\u5740"}[e.language],key:"rtspLiveUrl",width:150},{title:{CN:"Rtsp\u5F55\u64AD\u5730\u5740",EN:"Delayed URL",TW:"Rtsp\u9304\u64AD\u5730\u5740"}[e.language],key:"rtspHisUrl",width:150},{title:{CN:"\u89C6\u91CE\u89D2\u5EA6",EN:"Angle",TW:"\u8996\u91CE\u89D2\u5EA6"}[e.language],key:"angle",width:100},{title:{CN:"\u534A\u5F84",EN:"Radius",TW:"\u534A\u5F91"}[e.language],key:"radius",width:100},{title:{CN:"\u64CD\u4F5C",EN:"Operation",TW:"\u64CD\u4F5C"}[e.language],key:"operation",width:80,fixed:"right",render:function(a){var i="";return i=pageVue.functionInfo.isDefense?{CN:"\u5220\u9664",EN:"Delete",TW:"\u5220\u9664"}[e.language]:{CN:"\u67E5\u770B",EN:"View",TW:"\u67E5\u770B"}[e.language],a("div",[a("Button",{props:{type:"error",size:"small"},on:{click:function(){}}},i)])}}],camersDatas:[],cameraList:[],alarmColumns:[],alarmDatas:[],isSearchLoading:!1,vehicleUseStatusList:t.vehicleUseStatus,searchColumns:[{title:{CN:"\u8F66\u724C\u53F7",EN:"Plate No.",TW:"\u8ECA\u724C\u865F"}[e.language],key:"licenseNumber",fixed:"left",width:130},{title:{CN:"\u8FD0\u52A8\u72B6\u6001",EN:"Vehicle State",TW:"\u8ECA\u8F1B\u72C0\u614B"}[e.language],key:"vehicleStatus",align:"center",width:100},{title:{CN:"\u8F66\u8F86\u540D\u79F0",EN:"Vehicle Name",TW:"\u8ECA\u8F1B\u540D\u7A31"}[e.language],key:"vehicleName",width:130},{title:{CN:"\u8F66\u8F86\u7F16\u53F7",EN:"Vehicle Number",TW:"\u8ECA\u8F1B\u7DE8\u865F"}[e.language],key:"vehicleCode",width:130},{title:{CN:"\u64CD\u4F5C",EN:"Operation",TW:"\u64CD\u4F5C"}[e.language],key:"operation",width:i.isViewVideo?120:80,fixed:"right",render:function(a,n){var t=a("Button",{props:{size:"small"}},{CN:"\u8BE6\u60C5",EN:"Detail",TW:"\u8A73\u60C5"}[e.language]),o=null;return i.isViewVideo&&pageVue.vehiclePositionList[n.index].licenseNumber&&100>pageVue.vehiclePositionList[n.index].providerId&&(401==pageVue.vehiclePositionList[n.index].vehicleStatus||402==pageVue.vehiclePositionList[n.index].vehicleStatus)&&(t=a("Button",{props:{type:"primary",size:"small"},on:{click:function(){pageVue.showLiveVideo(pageVue.vehiclePositionList[n.index],0)}}},"\u5B9E\u65F6"),2!=pageVue.vehiclePositionList[n.index].providerId&&(o=a("Button",{props:{size:"small",type:"warning"},class:"backPlay",style:{marginLeft:"2px"},on:{click:function(){pageVue.showLiveVideo(pageVue.vehiclePositionList[n.index],1)}}},"\u56DE\u653E"))),a("div",[t,o])}}],searchDatas:[]},watch:{layerControl:function(e){var a=this,i=-1!=e.indexOf("seat"),n=-1!=e.indexOf("satellite"),t=-1!=e.indexOf("alarm"),o=-1!=e.indexOf("defens"),s=-1!=e.indexOf("camera"),r=-1!=e.indexOf("vehicle"),d=-1!=e.indexOf("background");a.baiduMapInfo.layersInfo.isVehicle=r,a.baiduMapInfo.layersInfo.isCamera=s,a.baiduMapInfo.layersInfo.isDefense=o}},methods:{refresh:function(){var e=window.location.href.split("?");window.location.href=e[0]+"?v="+Date.parse(new Date)},autoFocus:function(){this;$("body").find(".detailInfoModal input").on("click",function(){$(this).focus()})},showModal:function(e){var a=this;for(var i in a.modal)a.modal[i]=!1;a.modal[e]=!0},resetView:function(){var e=this;e.baiduMapInfo.map.centerAndZoom(new BMap.Point(e.airPort[0],e.airPort[1]),16)},getCompanyList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.getCompanyList,actionUrl:CONFIG.SERVICE.companyService,dataObj:{id:0,pageSize:1e4},successCallback:function(a){200==a.code&&(e.companyList=a.data)}})},getSuper:function(e,a,n){for(var t=this,o=0,s=e.length;o<s;o++)if(e[o].value==a){if(n.push(a),0==e[o].paraDeptId)return;t.getSuper(t.departmentList,e[o].paraDeptId,n)}else t.getSuper(e[o].children,a,n)},formatSuperiorDeprt:function(e){var a=this,i=JSON.stringify(e).replace(/id/g,"value").replace(/deptName/g,"label").replace(/subDeptList/g,"children");a.departmentList=JSON.parse(i)},getDepartmentList:function(e){var a=this;a.departmentList=[],utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.deptService+"?action="+CONFIG.ACTION.getDeptTreeList,actionUrl:CONFIG.SERVICE.deptService,dataObj:{id:0,pageSize:1e4,companyId:a[e].companyId||0},successCallback:function(i){if(200==i.code){var n=[];a[e].deptIds=[],a.formatSuperiorDeprt(i.data),a.getSuper(a.departmentList,a[e].deptId,n),a[e].deptIds=n.reverse()}}})},openInfoWindowClose:function(){var e=this;e.baiduMapInfo.openInfoWindow.show=!1,e.baiduMapInfo.openInfoWindow.type="",e.isTrackItem=!1,e.openInfoWidth=0,e.openInfoHeight=0,e.drawAlVehicleByBaidu()},setLayerTypeNormal:function(){var e=this;e.baiduMapInfo.mapType="BMAP_NORMAL_MAP"},setLayerTypeHybrid:function(){var e=this;e.baiduMapInfo.mapType="BMAP_HYBRID_MAP"},baiduMapHandle:function(e){var a=this;a.baiduMapInfo.center.lng=a.airPort[0],a.baiduMapInfo.center.lat=a.airPort[1],a.baiduMapInfo.zoom=16,a.baiduMapInfo.map=e.map,BMap=e.BMap,a.getAllVehiclePositonList(),a.getCompanyList(),a.functionInfo.isCamera&&a.getCameraList(!0),a.functionInfo.isDefense&&a.getDefensAreaList(!0),a.getAllVehicleInterval(),a.baiduMapInfo.overviewMapControl=new BMap.OverviewMapControl({isOpen:!0,size:new BMap.Size(300,200)}),a.baiduMapInfo.map.addControl(a.baiduMapInfo.overviewMapControl),$(".radar")[0]&&new Radar($(".radar")[0]).init({scanSpeed:2})},baiduMapClick:function(e){var a=this;if(null==e.overlay)if(!0==a.isAddCameraAction){if(!1==a.baiduMapInfo.layersInfo.isCamera)return a.$Message.destroy(),void a.$Message.error("\u8BF7\u5728\u56FE\u5C42\u63A7\u5236\u5F00\u542F\u6444\u50CF\u673A\u5C42");a.cameraDetailInfo={id:"",companyId:"",companyName:"",deptId:"",deptIds:[],deptName:"",cameraName:"",cameraCode:"",cameraDesc:"",cameraPosition:JSON.stringify({coordinates:[e.point.lng,e.point.lat]}),cameraPositionStr:e.point.lng+","+e.point.lat,radius:"",angle:"",monitorStatus:"",remark:"",rtspLiveUrl:"",rtspHisUrl:"",index:a.baiduMapInfo.cameraMarkers.length,createUserId:n.id,modifyUserId:n.id},a.createCameraFeature(a.cameraDetailInfo,function(){a.baiduMapInfo.map.panTo(new BMap.Point(e.point.lng,e.point.lat)),a.baiduMapInfo.openInfoWindow.position={lng:e.point.lng,lat:e.point.lat},a.openInfoWidth=450,a.openInfoHeight=290,a.baiduMapInfo.openInfoWindow.type="isCameraPop",a.baiduMapInfo.openInfoWindow.show=!0,a.isAddCameraAction=!1})}else if(!0==a.isAddDefensAction){if(!1==a.baiduMapInfo.layersInfo.isDefense)return a.$Message.destroy(),void a.$Message.error("\u8BF7\u5728\u56FE\u5C42\u63A7\u5236\u5F00\u542F\u9632\u533A\u5C42");a.baiduMapInfo.defensPath.push({lng:e.point.lng,lat:e.point.lat}),a.baiduMapInfo.isCloseDefensPath=!!(3<=a.baiduMapInfo.defensPath.length),a.defensAreaDetailInfo={id:"",opType:1,companyId:"",fill:"#ffffff",stroke:"blue",deptId:"",deptIds:[],areaName:"",areaCode:"",secureStatus:"",areaRangeStr:"",speedLimit:"",staySecond:"",canEnter:"",canExit:"",canStay:"",remark:"",createUserId:n.id,modifyUserId:n.id};var t=[],o=a.baiduMapInfo.defensPath;if(0<o.length){for(var s=0,r=o.length;s<r;s++)t.push(o[s].lng+","+o[s].lat);t.push(t[0]),a.defensAreaDetailInfo.areaRangeStr=t.join(";")}}},resetClickSearch:function(){$("#ol-dbClickSearch").css({opacity:0,left:"-300px",top:"auto",bottom:"120px"})},dbClickBaiduMap:function(e){var a=this,i=e.pixel,n=e.point;a.isTrackItem=!1,$("#ol-dbClickSearch").css({opacity:1,left:i.x-280,top:i.y-230,bottom:"auto"}),setTimeout(function(){a.convertorByBaiduToGPS([n.lng,n.lat],function(e,i){a.baiduMapInfo.vehicleMarkers={},a.vehiclePositonPageInfo.centerPosition=e+","+i,a.getAllVehiclePositonList()})},2e3)},cancelAreaSearch:function(){var e=this;e.vehiclePositonPageInfo.centerPosition="",e.vehiclePositonPageInfo.span=1e3,e.getAllVehiclePositonList()},endDefensEdite:function(){var e=this;!0==e.isAddDefensAction&&e.deleteDefensAction()},convertorByBaidu:function(e,a){var i=this,n=gcoord.transform([parseFloat(e[0]),parseFloat(e[1])],gcoord.WGS84,gcoord.BD09),t=new BMap.Point(n[0],n[1]);!a||a(t,n[0],n[1])},convertorByBaiduToGPS:function(e,a){var i=this,n=gcoord.transform([parseFloat(e[0]),parseFloat(e[1])],gcoord.BD09,gcoord.WGS84);!a||a(n[0],n[1])},setAnimationByBaidu:function(e){var a=this;a.convertorByBaidu(e,function(e){a.baiduMapInfo.map.panTo(e)})},setDefensRowData:function(e,a){var i=this,n=[];return i.defensAreaDetailInfo=i.defensList[a],i.defensAreaDetailInfo.remark=decodeURI(i.defensList[a].remark),i.defensAreaDetailInfo.opType=2,i.defensAreaDetailInfo.areaRange?void(n=JSON.parse(i.defensAreaDetailInfo.areaRange).coordinates[0],i.getDepartmentList("defensAreaDetailInfo"),i.openInfoWidth=550,i.openInfoHeight=290,i.baiduMapInfo.openInfoWindow.position={lng:n[0][0],lat:n[0][1]},i.baiduMapInfo.openInfoWindow.type="isDefenPop",i.baiduMapInfo.openInfoWindow.show=!0,i.baiduMapInfo.map.panTo(new BMap.Point(n[0][0],n[0][1]))):void i.$Message.error("\u6CA1\u6709\u9632\u533A\u5B9A\u4F4D\u6570\u636E")},showDefensPop:function(e,a){var i=this,n=a.point;i.defensAreaDetailInfo=e,i.getDepartmentList("defensAreaDetailInfo"),i.openInfoWidth=550,i.openInfoHeight=290,i.baiduMapInfo.openInfoWindow.position={lng:n.lng,lat:n.lat},i.baiduMapInfo.openInfoWindow.type="isDefenPop",i.baiduMapInfo.openInfoWindow.show=!0,i.baiduMapInfo.map.panTo(new BMap.Point(n.lng,n.lat))},defensStatuChange:function(e,a){var i=this;e.id?(i.baiduMapInfo.defensList["_"+e.id].fill=i.defensColor["_"+a].fill,i.baiduMapInfo.defensList["_"+e.id].stroke=i.defensColor["_"+a].stroke):(i.defensAreaDetailInfo.fill=i.defensColor["_"+a].fill,i.defensAreaDetailInfo.stroke=i.defensColor["_"+a].stroke)},drawAllDefens:function(){var e=this;e.baiduMapInfo.defensList={};for(var a=0,n=e.defensList.length;a<n;a++)if(e.defensList[a].areaRange){var t=JSON.parse(e.defensList[a].areaRange).coordinates[0];e.baiduMapInfo.defensList["_"+e.defensList[a].id]={id:"_"+e.defensList[a].id,canEdit:!!e.functionInfo.isDefense,style:e.functionInfo.isDefense?"dashed":"solid",fill:e.defensColor["_"+e.defensList[a].secureStatus].fill,stroke:e.defensColor["_"+e.defensList[a].secureStatus].stroke,paths:function(){for(var e=[],a=0,i=t.length;a<i;a++)e.push({lng:t[a][0],lat:t[a][1]});return e}(),item:e.defensList[a]}}},updateDefensPath:function(e,a){var n=this,t=[],o=a.target.getPath();if(n.defensAreaDetailInfo=e,n.defensAreaDetailInfo.remark=decodeURI(e.remark),n.getDepartmentList("defensAreaDetailInfo"),0<o.length){for(var s=0,r=o.length;s<r;s++)t.push(o[s].lng+","+o[s].lat);t.push(t[0]),n.defensAreaDetailInfo.areaRangeStr=t.join(";"),!e.id||(n.defensAreaDetailInfo.opType=3,setTimeout(function(){n.uploadDefensAreaDetailInfoToServer()},500))}},formatDefensData:function(){for(var e=this,a=0,n=e.defensList.length;a<n;a++)e.defensDatas.push({areaName:decodeURI(e.defensList[a].areaName),areaCode:decodeURI(e.defensList[a].areaCode),secureStatus:function(){for(var i="",n=0,t=e.secureAreaStatusList.length;n<t;n++)if(e.secureAreaStatusList[n].type==e.defensList[a].secureStatus){i=e.secureAreaStatusList[n].name;break}return i}(),speedLimit:e.defensList[a].speedLimit,staySecond:e.defensList[a].staySecond})},getDefensAreaList:function(e){var a=this;!0==e&&(a.defensDatas=[],a.defensList=[],a.defensPageInfo.pageNum=1),setTimeout(function(){utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.areaService+"?action="+CONFIG.ACTION.getSecureAreaList,actionUrl:CONFIG.SERVICE.areaService,dataObj:a.defensPageInfo,successCallback:function(e){200==e.code&&(a.defensList=e.data,a.defensPageInfo.count=e.count,a.formatDefensData(),a.drawAllDefens())}})},500)},defensPageSizeChange:function(){var e=this;e.defensPageInfo.pageNum=parseInt(value,10),setTimeout(function(){e.getDefensAreaList(!1)},200)},addDefensAction:function(){var e=this;e.isAddDefensAction=!0,e.baiduMapInfo.defensPath=[]},deleteDefensAction:function(){var e=this;e.isAddDefensAction=!1,e.showDefensPop(e.defensAreaDetailInfo,{point:e.baiduMapInfo.defensPath[0]})},deleteDefensArea:function(){var e=this;e.baiduMapInfo.openInfoWindow.type="",e.baiduMapInfo.openInfoWindow.show=!1,e.defensAreaDetailInfo.id?!1==e.addLoading&&utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.areaService+"?action="+CONFIG.ACTION.delSecureArea,actionUrl:CONFIG.SERVICE.areaService,dataObj:{ids:e.defensAreaDetailInfo.id,modifyUserId:n.id},beforeSendCallback:function(){e.addLoading=!0},completeCallback:function(){e.addLoading=!1},successCallback:function(a){200==a.code?(e.getDefensAreaList(!0),e.deleteLoading=!1,e.isDeleteDefens=!1,e.defensAreaDetailInfo={id:"",opType:1,companyId:"",fill:"#ffffff",stroke:"blue",deptId:"",deptIds:[],areaName:"",areaCode:"",secureStatus:"",areaRangeStr:"",speedLimit:"",staySecond:"",canEnter:"",canExit:"",canStay:"",remark:"",createUserId:n.id,modifyUserId:n.id}):e.$Message.error(a.message)}}):e.baiduMapInfo.defensPath=[]},uploadDefensAreaDetailInfoToServer:function(){var e=this;!1==e.addLoading&&utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.areaService+"?action="+CONFIG.ACTION.saveSecureArea,actionUrl:CONFIG.SERVICE.areaService,dataObj:{id:e.defensAreaDetailInfo.id,opType:e.defensAreaDetailInfo.opType,companyId:e.defensAreaDetailInfo.companyId,deptId:e.defensAreaDetailInfo.deptIds[e.defensAreaDetailInfo.deptIds.length-1]||0,areaName:encodeURI(e.defensAreaDetailInfo.areaName),areaCode:encodeURI(e.defensAreaDetailInfo.areaCode),secureStatus:e.defensAreaDetailInfo.secureStatus,areaRangeStr:e.defensAreaDetailInfo.areaRangeStr,speedLimit:e.defensAreaDetailInfo.speedLimit,staySecond:e.defensAreaDetailInfo.staySecond,canEnter:e.defensAreaDetailInfo.canEnter||720,canExit:e.defensAreaDetailInfo.canExit||720,canStay:e.defensAreaDetailInfo.canStay||720,remark:encodeURI(e.defensAreaDetailInfo.remark),createUserId:e.defensAreaDetailInfo.createUserId,modifyUserId:e.defensAreaDetailInfo.modifyUserId},beforeSendCallback:function(){e.addLoading=!0},completeCallback:function(){e.addLoading=!1},successCallback:function(a){200==a.code?(e.getDefensAreaList(!0),e.baiduMapInfo.defensPath=[]):e.$Message.error(a.message)}})},formatCameraData:function(){for(var e=this,a=0,n=e.cameraList.length;a<n;a++)e.camersDatas.push({id:e.cameraList[a].id,companyId:e.cameraList[a].companyId,companyName:decodeURI(e.cameraList[a].companyName),deptId:e.cameraList[a].deptId,deptName:decodeURI(e.cameraList[a].deptName),cameraName:decodeURI(e.cameraList[a].cameraName),cameraCode:decodeURI(e.cameraList[a].cameraCode),cameraDesc:decodeURI(e.cameraList[a].cameraDesc),radius:e.cameraList[a].radius,cameraPositionStr:e.cameraList[a].cameraPositionStr,angle:e.cameraList[a].angle,monitorStatus:e.cameraList[a].monitorStatusName,remark:decodeURI(e.cameraList[a].remark),rtspLiveUrl:e.cameraList[a].rtspLiveUrl,rtspHisUrl:e.cameraList[a].rtspHisUrl})},getCameraList:function(e){var a=this;a.camersDatas=[],a.cameraList=[],!0==e&&(a.cameraPageInfo.pageNum=1),setTimeout(function(){utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.deviceService+"?action="+CONFIG.ACTION.getCameraList,actionUrl:CONFIG.SERVICE.deviceService,dataObj:a.cameraPageInfo,successCallback:function(e){200==e.code&&(a.cameraList=e.data,a.cameraPageInfo.count=e.count,a.formatCameraData(),a.drawAllCamera())}})},500)},createCameraFeature:function(e,a){var i=this,n=JSON.parse(e.cameraPosition).coordinates;i.baiduMapInfo.cameraMarkers.push({icon:{url:CONFIG.HOST+"/airport/assets/img/camera.png?v="+Date.parse(new Date),size:{width:50,height:50}},position:{lng:n[0],lat:n[1]},item:e}),!a||a(e.id,n)},dragendCamera:function(e,a){var i=this,n=a.point;i.cameraDetailInfo=i.baiduMapInfo.cameraMarkers[e].item,i.cameraDetailInfo.cameraPosition=JSON.stringify({coordinates:[n.lng,n.lat]}),i.cameraDetailInfo.cameraPositionStr=n.lng+","+n.lat,i.baiduMapInfo.cameraMarkers[e].position={lng:n.lng,lat:n.lat},i.baiduMapInfo.openInfoWindow.position={lng:n.lng,lat:n.lat},!i.cameraDetailInfo.id||i.uploadCameraDetailInfoToServer()},drawAllCamera:function(){var e=this;e.baiduMapInfo.cameraMarkers=[];for(var a=0,n=e.cameraList.length;a<n;a++)e.createCameraFeature(e.cameraList[a])},setCameraRowData:function(e,a){var i=this,n=[];i.cameraDetailInfo=i.cameraList[a],i.cameraDetailInfo.remark=decodeURI(i.cameraList[a].remark),i.cameraDetailInfo.cameraName=decodeURI(i.cameraList[a].cameraName),i.cameraDetailInfo.cameraCode=decodeURI(i.cameraList[a].cameraCode),i.cameraDetailInfo.cameraDesc=decodeURI(i.cameraList[a].cameraDesc),n=JSON.parse(i.cameraDetailInfo.cameraPosition).coordinates,i.getDepartmentList("cameraDetailInfo"),i.openInfoWidth=450,i.openInfoHeight=290,i.baiduMapInfo.openInfoWindow.position={lng:n[0],lat:n[1]},i.baiduMapInfo.map.panTo(new BMap.Point(n[0],n[1])),i.baiduMapInfo.openInfoWindow.type="isCameraPop",i.baiduMapInfo.openInfoWindow.show=!0},cameraOpenPop:function(e){var a=this;a.baiduMapInfo.openInfoWindow.type="",a.baiduMapInfo.openInfoWindow.show=!1,a.getDepartmentList("cameraDetailInfo"),a.openInfoWidth=450,a.openInfoHeight=290,setTimeout(function(){a.baiduMapInfo.openInfoWindow.show=!0,a.baiduMapInfo.openInfoWindow.position=e.position,a.baiduMapInfo.openInfoWindow.type="isCameraPop",a.cameraDetailInfo=e.item,a.baiduMapInfo.map.panTo(new BMap.Point(e.position.lng,e.position.lat))},250)},cameraPageSizeChange:function(){var e=this;e.cameraPageInfo.pageNum=parseInt(value,10),setTimeout(function(){e.getCameraList(!1)},200)},deleteCamera:function(){var e=this;e.baiduMapInfo.openInfoWindow.type="",e.baiduMapInfo.openInfoWindow.show=!1,e.cameraDetailInfo.id?utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.deviceService+"?action="+CONFIG.ACTION.delCamera,actionUrl:CONFIG.SERVICE.deviceService,dataObj:{ids:e.cameraDetailInfo.id,modifyUserId:n.id},successCallback:function(a){200==a.code?(e.getCameraList(!0),setTimeout(function(){e.deleteLoading=!1,e.isDeleteCamera=!1,e.cameraDetailInfo={id:"",companyId:"",companyName:"",deptId:"",deptIds:[],deptName:"",cameraName:"",cameraCode:"",cameraDesc:"",cameraPositionStr:"",radius:"",angle:"",monitorStatus:"",remark:"",rtspLiveUrl:"",rtspHisUrl:"",createUserId:n.id,modifyUserId:n.id}},500)):e.$Message.error(a.message)}}):e.baiduMapInfo.cameraMarkers.splice(e.cameraDetailInfo.index,1)},uploadCameraDetailInfoToServer:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.deviceService+"?action="+CONFIG.ACTION.saveCamera,actionUrl:CONFIG.SERVICE.deviceService,dataObj:{id:e.cameraDetailInfo.id,companyId:e.cameraDetailInfo.companyId,deptId:e.cameraDetailInfo.deptIds[e.cameraDetailInfo.deptIds.length-1]||0,cameraName:encodeURI(e.cameraDetailInfo.cameraName),cameraCode:encodeURI(e.cameraDetailInfo.cameraCode),cameraDesc:encodeURI(e.cameraDetailInfo.cameraDesc),radius:e.cameraDetailInfo.radius,angle:e.cameraDetailInfo.angle,cameraPositionStr:e.cameraDetailInfo.cameraPositionStr,monitorStatus:e.cameraDetailInfo.monitorStatus,remark:encodeURI(e.cameraDetailInfo.remark),rtspLiveUrl:e.cameraDetailInfo.rtspLiveUrl,rtspHisUrl:e.cameraDetailInfo.rtspHisUrl,createUserId:n.id,modifyUserId:n.id},successCallback:function(a){200==a.code?(e.getCameraList(!0),setTimeout(function(){e.baiduMapInfo.openInfoWindow.type="",e.baiduMapInfo.openInfoWindow.show=!1,e.addLoading=!1},500)):e.$Message.error(a.message)}})},getAllVehiclePositonList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.vehicleService+"?action="+CONFIG.ACTION.getAllVehiclePositonList,actionUrl:CONFIG.SERVICE.vehicleService,dataObj:{span:e.vehiclePositonPageInfo.span||1e3,deptId:e.vehiclePositonPageInfo.deptId,pageNum:e.vehiclePositonPageInfo.pageNum,pageSize:e.vehiclePositonPageInfo.pageSize,id:e.vehiclePositonPageInfo.id,companyId:e.vehiclePositonPageInfo.companyId,gpsDeviceCode:e.vehiclePositonPageInfo.gpsDeviceCode,vehicleTypeId:e.vehiclePositonPageInfo.vehicleTypeId,vehicleStatus:e.vehiclePositonPageInfo.vehicleStatus,useStatus:e.vehiclePositonPageInfo.useStatus,vehicleColorId:e.vehiclePositonPageInfo.vehicleColorId,vehicleBrandId:e.vehiclePositonPageInfo.vehicleBrandId,centerPosition:e.vehiclePositonPageInfo.centerPosition,vehicleName:encodeURI(e.vehiclePositonPageInfo.vehicleName),vehicleCode:encodeURI(e.vehiclePositonPageInfo.vehicleCode),licenseNumber:encodeURI(e.vehiclePositonPageInfo.licenseNumber)},beforeSendCallback:function(){e.isSearchLoading=!0},completeCallback:function(){e.isSearchLoading=!1},successCallback:function(a){200==a.code&&(e.searchDatas=[],e.vehiclePositionList=a.data,e.vehiclePositonPageInfo.count=a.count,e.formatVehiclePositon(),e.resetClickSearch(),e.drawAlVehicleByBaidu())}})},formatVehiclePositon:function(){for(var e=this,a=0,n=e.vehiclePositionList.length;a<n;a++)e.searchDatas.push({o:e.vehiclePositionList[a].o,id:e.vehiclePositionList[a].id,speed:e.vehiclePositionList[a].speed,power:e.vehiclePositionList[a].power,deptId:e.vehiclePositionList[a].deptId,deptName:e.vehiclePositionList[a].deptName,modifyTime:e.vehiclePositionList[a].modifyTime,gpsDeviceId:e.vehiclePositionList[a].gpsDeviceId,companyName:e.vehiclePositionList[a].companyName,vehicleName:e.vehiclePositionList[a].vehicleName,vehicleCode:e.vehiclePositionList[a].vehicleCode,licenseNumber:e.vehiclePositionList[a].licenseNumber,lastPosition:e.vehiclePositionList[a].lastPosition?JSON.parse(e.vehiclePositionList[a].lastPosition).coordinates:null,vehicleTypeId:e.vehiclePositionList[a].vehicleTypeName,gpsDeviceCode:e.vehiclePositionList[a].gpsDeviceCode,providerId:e.vehiclePositionList[a].providerId,vehicleStatus:function(){var i=$.grep(e.terminalStatusList,function(i){return i.type==e.vehiclePositionList[a].vehicleStatus});return i&&0!=i.length?i[0].name:"--"}(),useStatus:e.vehiclePositionList[a].useStatusName,vehicleColorId:e.vehiclePositionList[a].vehicleColorName,vehicleBrandId:e.vehiclePositionList[a].vehicleBrandName,vehicleStatusName:e.vehiclePositionList[a].vehicleStatusName,cellClassName:{vehicleStatus:"_"+e.vehiclePositionList[a].vehicleStatus}})},searchTimeVehicle:function(){var e=this;e.getAllVehiclePositonList()},getBeginDate:function(e){var a=this;a.dateTimeInfo.beginDate=e},getEndDate:function(e){var a=this;a.dateTimeInfo.endDate=e},getBeginTime:function(e){var a=this;a.dateTimeInfo.beginTime=e},getEndTime:function(e){var a=this;a.dateTimeInfo.endTime=e},getAdressDetail:function(e,a,i){this;a.gc=new BMap.Geocoder,a.sourceCoor=e,a.point=new BMap.Point(a.sourceCoor[0],a.sourceCoor[1]),a.gc.getLocation(a.point,function(e){a.address=0<e.surroundingPois.length?e.surroundingPois[0].address+"("+e.surroundingPois[0].title+")":e.address,!i||i()})},formatTrajectoryInfo:function(){var e=this,a=null,n=[];if(!!e.singleVehicleItem&&e.singleVehicleItem.track){a=e.singleVehicleItem.track.split("/");for(var t,o=0,s=a.length;o<s;o++)t=a[o].split(","),n.push({time:function(){var e=utility.getDateDetailInfo(t[2]);return e.year+"-"+e.month+"-"+e.date+" "+e.hour+":"+e.min+":"+e.second}(),speed:t[3],coordinate:[parseFloat(t[0],10),parseFloat(t[1],10)],vehicleCode:e.singleVehicleItem.vehicleCode,vehicleStatus:e.singleVehicleItem.vehicleStatus,companyName:e.singleVehicleItem.companyName,deptName:e.singleVehicleItem.deptName,vehicleName:e.singleVehicleItem.vehicleName,licenseNumber:e.singleVehicleItem.licenseNumber,lastGpsTime:e.singleVehicleItem.lastGpsTime,vehicleTypeName:e.singleVehicleItem.vehicleTypeName}),e.convertorByBaidu([t[0],t[1]],function(a,i,n){e.baiduMapInfo.animationInfo.coordinates.push({lng:i,lat:n})})}e.baiduMapInfo.animationInfo.curveInfo=e.baiduMapInfo.animationInfo.coordinates,e.baiduMapInfo.animationInfo.pointInfo=e.baiduMapInfo.animationInfo.coordinates,e.baiduMapInfo.animationInfo.trajectoryInfo=n},showLiveVideo:function(e,a){var i=this,t="http://43.247.68.26:8080/airport/www/module/liveVideo/liveVideo.html?vehicleInfo="+encodeURI(JSON.stringify(e))+"&isBackPlay="+a;a&&(t="http://43.247.68.26:8080/airport/www/module/playBack/liveVideo.html?vehicleInfo="+encodeURI(JSON.stringify(e))+"&isBackPlay="+a),2==e.providerId&&(a?t="http://43.247.68.26:8080/airport/www/module/playBack/liveVideo.html?vehicleInfo="+encodeURI(JSON.stringify(e))+"&isBackPlay="+a:t="http://43.247.68.26:8080/airport/www/module/liveVideoTest1/liveVideo.html?vehicleInfo="+encodeURI(JSON.stringify(e))+"&id="+n.id+"&userToken="+n.userToken+"&isBackPlay="+a),window.open(t,"liveVideo","toolbar=yes, location=0, directories=no, status=0, menubar=0, scrollbars=1, resizable=1, copyhistory=1, width="+window.outerWidth+", height="+(window.outerHeight-50))},createVehicleByBaidu:function(e,a){var i=this;if(e.lastPosition){var n=JSON.parse(e.lastPosition).coordinates,o=CONFIG.HOST+"/airport/assets/car/success.gif",s=function(){for(var e={},a=0,n=t.vehicleType.length;a<n;a++)e[t.vehicleType[a].name]=t.vehicleType[a].type+"";return e}(),r=s[e.vehicleTypeName]+e.vehicleStatus||e.vehicleStatus;o=CONFIG.HOST+"/airport/assets/car/"+r+".gif?v="+Date.parse(new Date),i.convertorByBaidu(n,function(n,t,s){i.baiduMapInfo.vehicleMarkers["_"+e.id]?(0!=i.baiduMapInfo.vehicleMarkers["_"+e.id].position.lng-t||0!=i.baiduMapInfo.vehicleMarkers["_"+e.id].position.lat-s)&&(i.baiduMapInfo.vehicleMarkers["_"+e.id].item=e,i.baiduMapInfo.vehicleMarkers["_"+e.id].zIndex=i.baiduMapInfo.vehicleMarkers["_"+e.id].zIndex||0,i.baiduMapInfo.vehicleMarkers["_"+e.id].position={lng:t,lat:s}):i.baiduMapInfo.vehicleMarkers["_"+e.id]={id:"_"+e.id,icon:{url:o,size:{width:28,height:35}},position:{lng:t,lat:s},zIndex:0,top:!1,animation:"",item:e},!a||a(t,s)})}},setVehicleTop:function(e){var a=this;!a.baiduMapInfo.vehicleMarkers[e.id]||(a.baiduMapInfo.vehicleMarkers[e.id].zIndex=1e10,a.baiduMapInfo.vehicleMarkers[e.id].top=!0,a.baiduMapInfo.vehicleMarkers[e.id].animation=""),a.openInfoWidth=360,a.openInfoHeight=0},cancelVehicleTop:function(e){var a=this;!a.baiduMapInfo.vehicleMarkers[e.id]||(a.baiduMapInfo.vehicleMarkers[e.id].zIndex=0,a.baiduMapInfo.vehicleMarkers[e.id].top=!1,a.baiduMapInfo.vehicleMarkers[e.id].animation="")},vehicleOpenPop:function(e){var a=this;a.baiduMapInfo.openInfoWindow.show=!1,a.baiduMapInfo.openInfoWindow.type="",a.isTrackItem=!0,a.openInfoWidth=360,a.openInfoHeight=0,setTimeout(function(){a.vehicleItemPop=e.item,a.singleVehiclePageInfo.licenseNumber=a.vehicleItemPop.licenseNumber,a.trackItem.licenseNumber=a.vehicleItemPop.licenseNumber,a.getAdressDetail([e.position.lng,e.position.lat],a.vehicleItemPop,function(){a.baiduMapInfo.openInfoWindow.show=!0,a.baiduMapInfo.openInfoWindow.type="isVehiclePopInfo",a.baiduMapInfo.openInfoWindow.position=e.position,a.baiduMapInfo.map.panTo(new BMap.Point(e.position.lng,e.position.lat)),a.drawAlVehicleByBaidu()})},250)},drawAlVehicleByBaidu:function(){var e=this;if(e.isTrackItem){e.baiduMapInfo.vehicleMarkers={};for(var a=0,n=e.vehiclePositionList.length;a<n;a++)if(e.trackItem.licenseNumber==e.vehiclePositionList[a].licenseNumber){e.createVehicleByBaidu(e.vehiclePositionList[a],function(a,i){"isVehiclePopInfo"==e.baiduMapInfo.openInfoWindow.type&&(e.baiduMapInfo.openInfoWindow.position={lng:a,lat:i})});break}}else for(var o=0,s=e.vehiclePositionList.length;o<s;o++)e.createVehicleByBaidu(e.vehiclePositionList[o])},showPositionByBaidu:function(e,a){var i=this,n=[],t="";i.vehiclePositionItem=i.vehiclePositionList[a],i.vehicleItemPop=i.vehiclePositionItem,i.singleVehiclePageInfo.licenseNumber=i.vehicleItemPop.licenseNumber,t=i.vehicleItemPop.lastPosition,t?(n=JSON.parse(t).coordinates,0==n[0]||0==n[1]?i.$Message.error("\u6CA1\u6709\u8F66\u8F86\u5B9A\u4F4D\u6570\u636E"):(i.setAnimationByBaidu(n),i.openInfoWidth=360,i.openInfoHeight=0,setTimeout(function(){i.convertorByBaidu(n,function(e,a,n){i.getAdressDetail([a,n],i.vehicleItemPop,function(){i.baiduMapInfo.openInfoWindow.position={lng:a,lat:n},i.baiduMapInfo.openInfoWindow.type="isVehiclePopInfo",i.baiduMapInfo.openInfoWindow.show=!0,i.isTrackItem=!0,i.trackItem.licenseNumber=i.singleVehiclePageInfo.licenseNumber,i.drawAlVehicleByBaidu()})})},1e3))):i.$Message.error("\u6CA1\u6709\u8F66\u8F86\u5B9A\u4F4D\u6570\u636E")},clearTrackByBaidu:function(){var e=this;e.baiduMapInfo.animationInfo.curveInfo=[],e.baiduMapInfo.animationInfo.pointInfo=[],e.baiduMapInfo.animationInfo.moveVehicle=null,clearInterval(e.baiduMapInfo.animationInfo.timeInterval)},showTrackPointInfo:function(e){for(var a=this,n=0,t=0,o=a.baiduMapInfo.animationInfo.coordinates.length;t<o;t++)if(e.point.lng==a.baiduMapInfo.animationInfo.coordinates[t].lng&&e.point.lng==a.baiduMapInfo.animationInfo.coordinates[t].lat){n=t;break}a.baiduMapInfo.animationInfo.trajectoryItem=a.baiduMapInfo.animationInfo.trajectoryInfo[n],a.getAdressDetail([e.point.lng,e.point.lat],a.baiduMapInfo.animationInfo.trajectoryItem,function(){a.baiduMapInfo.map.panTo(e.point),a.openInfoWidth=330,a.openInfoHeight=0,a.baiduMapInfo.openInfoWindow.position={lng:e.point.lng,lat:e.point.lat},a.baiduMapInfo.openInfoWindow.type="isTrajectPoint",a.baiduMapInfo.openInfoWindow.show=!0})},getSingleVehicleTrackByBaidu:function(){var e=this;return 0==e.dateTimeInfo.beginDate.length&&(e.dateTimeInfo.beginDate=function(){var e=utility.getDateDetailInfo();return e.year+"-"+e.month+"-"+e.date}()),0==e.dateTimeInfo.beginTime.length&&(e.dateTimeInfo.beginTime="00:00:00"),0==e.dateTimeInfo.endDate.length&&(e.dateTimeInfo.endDate=function(){var e=utility.getDateDetailInfo();return e.year+"-"+e.month+"-"+e.date}()),0==e.dateTimeInfo.endTime.length&&(e.dateTimeInfo.endTime="23:59:59"),e.singleVehiclePageInfo.beginTime=e.dateTimeInfo.beginDate+" "+e.dateTimeInfo.beginTime,e.singleVehiclePageInfo.endTime=e.dateTimeInfo.endDate+" "+e.dateTimeInfo.endTime,timeDiff=utility.timeDiff(e.singleVehiclePageInfo.beginTime,e.singleVehiclePageInfo.endTime),e.clearTrackByBaidu(),e.$Message.destroy(),!1==timeDiff.isOver?void e.$Message.error("\u5F00\u59CB\u65F6\u95F4\u5927\u4E8E\u7ED3\u675F\u65F6\u95F4"):3<timeDiff.day?void e.$Message.error("\u65F6\u95F4\u8DE8\u5EA6\u4E0D\u80FD\u8D85\u8FC73\u5929"):void(e.$Message.loading({content:"\u6B63\u5728\u52A0\u8F7D\u8F68\u8FF9..."}),utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.vehicleService+"?action="+CONFIG.ACTION.getSingleVehicleTrack,actionUrl:CONFIG.SERVICE.vehicleService,dataObj:{gpsDeviceCode:e.singleVehiclePageInfo.gpsDeviceCode,licenseNumber:encodeURI(e.singleVehiclePageInfo.licenseNumber),beginTime:e.singleVehiclePageInfo.beginTime,endTime:e.singleVehiclePageInfo.endTime},successCallback:function(a){200==a.code?(e.singleVehicleItem=a.data,e.showModal("isHistory"),e.singleVehicleItem.track?e.formatTrajectoryInfo():(e.$Message.destroy(),e.$Message.error(e.singleVehiclePageInfo.beginTime+"  "+e.singleVehiclePageInfo.endTime+"\u67E5\u8BE2\u4E0D\u5230\u8F68\u8FF9\u6570\u636E"),setTimeout(function(){e.$Message.destroy()},3e3))):(e.$Message.destroy(),e.$Message.error(a.message),setTimeout(function(){e.$Message.destroy()},3e3))},errorCallback:function(){e.$Message.destroy()}}))},playBackByBaidu:function(){var e=this,a=0,i=e.vehicleItemPop,n=e.baiduMapInfo.animationInfo.coordinates,o=function(){for(var e={},a=0,n=t.vehicleType.length;a<n;a++)e[t.vehicleType[a].name]=t.vehicleType[a].type+"";return e}(),s=o[i.vehicleTypeName]+i.vehicleStatus||i.vehicleStatus;e.baiduMapInfo.animationInfo.moveVehicle={icon:{url:CONFIG.HOST+"/airport/assets/car/"+s+".gif?v="+Date.parse(new Date),size:{width:28,height:35}},position:{lng:n[a].lng,lat:n[a].lat},zIndex:1e5,top:!0},e.baiduMapInfo.openInfoWindow.show=!1,e.baiduMapInfo.map.panTo(new BMap.Point(n[a].lng,n[a].lat)),e.baiduMapInfo.animationInfo.timeInterval=setInterval(function(){a<n.length?(a++,e.baiduMapInfo.animationInfo.moveVehicle.position=n[a],e.baiduMapInfo.map.panTo(new BMap.Point(n[a].lng,n[a].lat))):(e.baiduMapInfo.animationInfo.moveVehicle=null,clearInterval(e.baiduMapInfo.animationInfo.timeInterval))},10*(55+(55-e.baiduMapInfo.animationInfo.speed)))},getAllVehicleInterval:function(){var e=this;e.timePosition=setInterval(function(){"isCameraPop"==e.baiduMapInfo.openInfoWindow.type||"isDefenPop"==e.baiduMapInfo.openInfoWindow.type||e.getAllVehiclePositonList()},1e4)}},created:function(){var e=this;utility.isLogin(!1),e.$Message.config({top:180,duration:3}),e.showModal("isLayer"),e.$watch("vehiclePositonPageInfo",function(){clearInterval(e.timePosition),e.getAllVehiclePositonList(),e.timePosition=setInterval(function(){e.getAllVehiclePositonList()},1e4)},{deep:!0})},mouted:function(){this}})})();