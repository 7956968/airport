(function(){var e,a=utility.getLocalStorage("language"),t=(utility.getLocalStorage("userInfo"),utility.getLocalStorage("bizParam")),i=new Vue({el:"#js-vue",data:{language:a?a.language:"CN",isTableLoading:!0,isShowModal:!1,isShowTerminal:!1,isModalLoading:!0,modalTitle:"",tableHeight:(e=$(".tableContainer").height(),e-100),vehiclePassType:t.vehiclePassType,pageInfo:{count:0,pageNum:1,areaId:"",pageSize:20,areaName:"",areaCode:"",vehicleId:"",companyId:"",vehicleName:"",vehicleCode:"",crossTypeId:""},columnsList:[{type:"index",width:60,title:"序号",align:"center"},{title:{CN:"防区名称",EN:"Defense Name",TW:"防區名稱"}[a.language],key:"areaName"},{title:"车牌号",key:"licenseNumber"},{title:{CN:"类型",EN:"Type",TW:"類型"}[a.language],key:"crossTypeName"},{title:{CN:"行驶速度",EN:"Speed",TW:"行駛速度"}[a.language],key:"speed",render:function(e,a){return e("div",[e("span",{},a.row.speed+"公里/小时")])}},{title:{CN:"时间",EN:"Time",TW:"時間"}[a.language],key:"crossTime"},{title:{CN:"坐标",EN:"Coordinate",TW:"座標位置"}[a.language],key:"currPosition",render:function(e,a){var t=JSON.parse(i.dataList[a.index].currPosition).coordinates.join(",");return e("div",t)}},{title:{CN:"地址",EN:"Coordinate",TW:"座標位置"}[a.language],key:"lastAddress",width:360}],dataList:[],companyList:[]},methods:{refresh:function(){var e=this;window.location.href=window.location.href,0==e.isTableLoading&&(e.isTableLoading=!0,setTimeout(function(){e.isTableLoading=!1},3e3))},pageSizeChange:function(e){var a=this;a.pageInfo.pageNum=parseInt(e,10),setTimeout(function(){a.getCrossAreaList(!1)},200)},pageRowChange:function(e){var a=this;a.pageInfo.pageSize=parseInt(e,10),setTimeout(function(){a.getCrossAreaList(!1)},200)},getCrossAreaList:function(e){var a=this;a.dataList=[],1==e&&(a.pageInfo.pageNum=0),utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.vehicleService+"?action="+CONFIG.ACTION.getCrossAreaList,actionUrl:CONFIG.SERVICE.vehicleService,dataObj:{pageNum:a.pageInfo.pageNum,areaId:a.pageInfo.pageNum,pageSize:a.pageInfo.pageNum,areaName:encodeURI(a.pageInfo.areaName),areaCode:encodeURI(a.pageInfo.areaCode),vehicleId:a.pageInfo.vehicleId,companyId:a.pageInfo.companyId,vehicleName:encodeURI(a.pageInfo.vehicleName),vehicleCode:encodeURI(a.pageInfo.vehicleCode),crossTypeId:a.pageInfo.crossTypeId},beforeSendCallback:function(){a.isTableLoading=!0},completeCallback:function(){a.isTableLoading=!1},successCallback:function(e){if(200==e.code){var t=[];a.pageInfo.count=e.count;for(var i=0,o=e.data.length;i<o;i++)t.push(e.data[i]),t[i].lastAddress="";a.dataList=t;for(var n=0;n<e.data.length;n++)(function(t){if(a.dataList[t].lastAddress="",e.data[t].currPosition){var i=JSON.parse(e.data[t].currPosition).coordinates;0!=i[0]&&0!=i[1]?utility.convertorByBaidu(i,gcoord,BMap,function(e,i,o){utility.getAdressDetail([i,o],BMap,function(e){a.dataList[t].lastAddress=e})}):a.dataList[t].lastAddress="--"}else a.dataList[t].lastAddress="--"})(n)}}})},getCompanyList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.getCompanyList,actionUrl:CONFIG.SERVICE.companyService,dataObj:{id:0,pageSize:1e4},successCallback:function(a){200==a.code&&(e.companyList=a.data)}})}},created:function(){var e=this;utility.isLogin(!1),setTimeout(function(){e.getCompanyList(),e.getCrossAreaList(!0),e.$watch("pageInfo",function(){e.getCrossAreaList(!0)},{deep:!0})},500)}})})();