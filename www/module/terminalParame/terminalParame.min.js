(function(){var e,s=utility.getLocalStorage("language"),a=utility.getLocalStorage("userInfo"),o=utility.getLocalStorage("bizParam");new Vue({el:"#js-vue",data:{language:s?s.language:"CN",tableHeight:(e=$(".tableContainer").height(),e-100),loading:!1,type:1,userInfo:a,oldPass:"",newPass:"",companyList:[],sexTypeList:o.sexType},watch:{},methods:{reLogin:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.userService+"?action="+CONFIG.ACTION.userLogin+"&userCode="+e.userInfo.userCode+"&userPwd="+md5(e.newPass).toUpperCase(),actionUrl:CONFIG.SERVICE.userService,beforeSendCallback:function(){e.loading=!0},completeCallback:function(){e.loading=!1},successCallback:function(s){200==s.code?utility.setLocalStorage("userInfo",s.data):e.$Message.error(s.message)}})},modifyPassAction:function(){var e=this;return e.$Message.config({top:150,duration:3}),e.loading=!0,utility.checkLen($.trim(e.oldPass),0)?(e.$Message.error("旧密码不能为空"),void(e.loading=!1)):$.trim(e.newPass).length<=5?(e.$Message.error("新密码长度为6为以上字符"),void(e.loading=!1)):utility.checkPass($.trim(e.newPass))?$.trim(e.oldPass)==$.trim(e.newPass)?(e.$Message.error("旧密码不能与新密码一样"),void(e.loading=!1)):void utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.userService+"?action="+CONFIG.ACTION.changeUserPwd,actionUrl:CONFIG.SERVICE.userService,dataObj:{oldUserPwd:md5(e.oldPass).toUpperCase(),newUserPwd:md5(e.newPass).toUpperCase()},completeCallback:function(){e.loading=!1},successCallback:function(s){200==s.code?(e.$Message.success("修改成功!"),e.reLogin()):1056==s.code?e.$Message.error("旧密码错误"):e.$Message.error(s.message)}}):(e.$Message.error("新密码格式不正确"),void(e.loading=!1))},modifyUserInfoAction:function(){var e=this,s=utility.getDateDetailInfo(e.userInfo.birthday);e.$Message.config({top:150,duration:3}),e.loading=!0,utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.userService+"?action="+CONFIG.ACTION.saveUser,actionUrl:CONFIG.SERVICE.userService,dataObj:{id:e.userInfo.id,userCode:e.userInfo.userCode,userPwd:e.userInfo.userPwd,companyId:e.userInfo.companyId,userSeq:e.userInfo.userSeq,userName:encodeURI(e.userInfo.userName),sex:e.userInfo.sex,birthday:s.year+"-"+s.month+"-"+s.date,mobile:e.userInfo.mobile,telephone:e.userInfo.telephone,email:e.userInfo.email,remark:encodeURI(e.userInfo.remark),status:e.userInfo.status,idNo:e.userInfo.idNo,address:encodeURI(e.userInfo.address),createUserId:a.id,modifyUserId:a.id},completeCallback:function(){e.loading=!1},successCallback:function(s){200==s.code?(e.$Message.success("修改成功!"),utility.setLocalStorage("userInfo",e.userInfo)):e.$Message.error(s.message)}})},getLogByCode:function(e){var s=this;s.type=e},getCompanyList:function(){var e=this;utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.companyService+"?action="+CONFIG.ACTION.getCompanyList,actionUrl:CONFIG.SERVICE.companyService,dataObj:{id:0,pageSize:1e4},successCallback:function(s){200==s.code&&(e.companyList=s.data)}})}},created:function(){var e=this;utility.isLogin(!1),e.userInfo.address=decodeURI(e.userInfo.address),setTimeout(function(){e.getCompanyList()},500)}})})();