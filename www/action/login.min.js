(function(){var e=utility.getLocalStorage("language"),n=utility.getLocalStorage("userInfo");new Vue({el:"#js-vue",data:{language:e?e.language:"CN",loading:!1,isShowTips:!1,message:"",loginInfo:{userCode:n&&n.userCode?n.userCode:"",userPwd:n&&n.userPwd?n.userPwd:"",remember:!0},languageList:[{value:"CN",label:"中文"}],title:{CN:"民贵无动力设备管理系统",EN:"Mingui Non-Powered Euipment Management System",TW:"民貴無動力管理系統"}},watch:{language:function(e){var n=this;document.title=n.title[e],utility.setLocalStorage("language",{language:e}),setTimeout(function(){n.getBizParam()},500)}},methods:{validateInput:function(){var e=this;return e.$Message.config({top:150,duration:3}),utility.checkLen(e.loginInfo.userCode,0)?(e.$Message.error({CN:"请输入用户名",EN:"Please Enter userCode",TW:"請輸入用戶名"}[e.language]),!1):!utility.checkLen(e.loginInfo.userPwd,0)||(e.$Message.error({CN:"请输入密码",EN:"Please Enter Password",TW:"請輸入密碼"}[e.language]),!1)},formatFunMenu:function(e){for(var n={menu_map:[],menu_org:[],menu_device:[],menu_report:[],menu_system:[]},t=e.userFuncList,i=0,a=t.length;i<a;i++)t[i].functionCode.indexOf("map_")==-1&&"device_manage_vehicle"!=t[i].functionCode&&"device_view_secure_area"!=t[i].functionCode&&"device_manage_secure_area"!=t[i].functionCode&&"device_manage_camera"!=t[i].functionCode&&"device_view_camera"!=t[i].functionCode||n.menu_map.push(t[i]),t[i].functionCode.indexOf("org_manage_")!=-1&&n.menu_org.push(t[i]),t[i].functionCode.indexOf("device_manage_")!=-1&&n.menu_device.push(t[i]),t[i].functionCode.indexOf("report_")!=-1&&n.menu_report.push(t[i]),t[i].functionCode.indexOf("system_")!=-1&&n.menu_system.push(t[i]);utility.setLocalStorage("userFuncList",n)},loginAction:function(){var e=this;e.loading||e.validateInput()&&utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.userService+"?action="+CONFIG.ACTION.userLogin+"&userCode="+e.loginInfo.userCode+"&userPwd="+md5(e.loginInfo.userPwd).toUpperCase(),actionUrl:CONFIG.SERVICE.userService,beforeSendCallback:function(){e.loading=!0},completeCallback:function(){e.loading=!1},successCallback:function(n){200==n.code?(utility.setLocalStorage("userInfo",n.data),utility.setLocalStorage("language",{language:e.language}),e.formatFunMenu(n.data),setTimeout(function(){window.location.href="/airport/www/module/index/index.html"},500)):e.$Message.error(n.message)}})},getBizParam:function(){utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.commonService+"?action="+CONFIG.ACTION.getBizParam,actionUrl:CONFIG.SERVICE.commonService,successCallback:function(e){200==e.code&&utility.setLocalStorage("bizParam",e.data)}})},getProvinceList:function(){utility.interactWithServer({url:CONFIG.HOST+CONFIG.SERVICE.commonService+"?action="+CONFIG.ACTION.getProvinceList,actionUrl:CONFIG.SERVICE.commonService,successCallback:function(e){200==e.code&&utility.setLocalStorage("provinceList",e.data)}})}},created:function(){var e=this;document.title=e.title[e.language],e.getBizParam(),e.getProvinceList(),document.onkeydown=function(n){var n=n||event,t=n.keyCode||n.while||n.charCode;13==t&&e.loginAction()}}})})();